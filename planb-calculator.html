<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë…¸í›„ìƒí™œë¹„ ê³„ì‚°ê¸° - í”Œëœë¹„ ì»¤ë®¤ë‹ˆí‹°</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            font-size: 18px;
            line-height: 1.6;
            background-color: #f8fafc;
        }
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 24px;
            margin-bottom: 16px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-community {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
        }
        .tab-button {
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        .tab-button.active {
            background: #3b82f6;
            color: white;
            border-color: #1d4ed8;
        }
        .tab-button:not(.active) {
            background: #f3f4f6;
            color: #6b7280;
        }
        .community-post {
            border-left: 4px solid #10b981;
            background: #f0fdf4;
            padding: 16px;
            margin-bottom: 12px;
            border-radius: 8px;
        }
        .anonymous-badge {
            background: #6b7280;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        .asset-badge {
            background: #3b82f6;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        .region-badge {
            background: #f59e0b;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        .reply {
            background: #f8fafc;
            border-left: 3px solid #d1d5db;
            margin-left: 20px;
            padding: 12px;
            margin-top: 8px;
            border-radius: 6px;
        }
        .service-card {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px;
            background: white;
            transition: all 0.3s;
        }
        .service-card:hover {
            border-color: #10b981;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.1);
        }
        .dday-badge {
            background: #dc2626;
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // === ì™„ì „í•œ ê³„ì‚°ê¸° ë¡œì§ (planb-2.0-final.htmlì—ì„œ ê°€ì ¸ì˜´) ===

        // ì•ˆì „ ì¸ì¶œìœ¨ ê³„ì‚°
        const calculateSafeWithdrawalRate = (age, health, mode, lifeExpectancy = 100) => {
            // ê¸°ëŒ€ìˆ˜ëª…ì— ë”°ë¥¸ ê¸°ë³¸ ì¸ì¶œìœ¨ ì¡°ì •
            const yearsToLive = lifeExpectancy - age;
            let baseRate = 0.035;
            
            // ê¸°ëŒ€ìˆ˜ëª…ì´ ê¸¸ìˆ˜ë¡ ë³´ìˆ˜ì ìœ¼ë¡œ, ì§§ì„ìˆ˜ë¡ ì ê·¹ì ìœ¼ë¡œ
            if (yearsToLive >= 45) baseRate = 0.032;      // 45ë…„ ì´ìƒ: ë§¤ìš° ë³´ìˆ˜ì 
            else if (yearsToLive >= 35) baseRate = 0.035; // 35-44ë…„: ê¸°ë³¸
            else if (yearsToLive >= 25) baseRate = 0.039; // 25-34ë…„: ì•½ê°„ ì ê·¹ì 
            else if (yearsToLive >= 15) baseRate = 0.042; // 15-24ë…„: ì ê·¹ì 
            else baseRate = 0.045;                        // 15ë…„ ë¯¸ë§Œ: ë§¤ìš° ì ê·¹ì 
            
            const adjustments = {
                health: { 'ì–‘í˜¸': 1.05, 'ë³´í†µ': 1.0, 'ì£¼ì˜í•„ìš”': 0.95 },
                mode: { 'ë³´ìˆ˜ì ': 0.85, 'ê· í˜•': 1.0, 'ì ê·¹ì ': 1.15 }
            };
            
            return baseRate * adjustments.health[health] * adjustments.mode[mode];
        };

        // ë‚˜ì´ë³„ í‰ê·  ë°ì´í„°
        const getAverageDataByAge = (age) => {
            if (age >= 65) {
                return { financialAssets: 8500, severancePay: 0, homeValue: 28000, nationalPension: 80, privatePension: 35, debt: 800 };
            } else if (age >= 55) {
                return { financialAssets: 12000, severancePay: 4500, homeValue: 35000, nationalPension: 120, privatePension: 65, debt: 2200 };
            } else if (age >= 45) {
                return { financialAssets: 8500, severancePay: 7000, homeValue: 40000, nationalPension: 140, privatePension: 85, debt: 3500 };
            } else {
                return { financialAssets: 5000, severancePay: 3000, homeValue: 30000, nationalPension: 100, privatePension: 50, debt: 2500 };
            }
        };

        // ê¸ˆì•¡ í¬ë§·íŒ…
        const formatAmount = (value) => {
            if (!value || value === '' || value === '0') return 'ğŸ’° 0ì›';
            const num = parseInt(value);
            if (num >= 10000) return `ğŸ’° ${(num / 10000).toFixed(1)}ì–µì›`;
            if (num >= 1000) return `ğŸ’° ${Math.round(num / 1000)}ì²œë§Œì›`;
            return `ğŸ’° ${num.toLocaleString()}ë§Œì›`;
        };

        const formatResultAmount = (amount) => {
            if (amount < 0) {
                return `-${formatResultAmount(-amount)}`;
            }
            
            const ì–µ = Math.floor(amount / 100000000);
            const ë§Œ = Math.round((amount % 100000000) / 10000);
            
            if (ì–µ >= 1) {
                if (ë§Œ === 0) {
                    return `${ì–µ}ì–µì›`;
                } else {
                    return `${ì–µ}ì–µ ${ë§Œ}ë§Œì›`;
                }
            } else {
                return `${ë§Œ}ë§Œì›`;
            }
        };

        // AmountInput ì»´í¬ë„ŒíŠ¸
        const AmountInput = ({ label, value, onChange, placeholder, averageAmount }) => (
            <div className="mb-6">
                <label className="block text-xl font-semibold text-gray-800 mb-3">{label}</label>
                <input
                    type="text"
                    inputMode="numeric"
                    pattern="[0-9]*"
                    value={value}
                    onChange={(e) => {
                        const numValue = e.target.value.replace(/[^0-9]/g, '');
                        onChange(numValue === '' ? '' : numValue);
                    }}
                    onDragStart={(e) => e.preventDefault()}
                    onDrop={(e) => e.preventDefault()}
                    onDragOver={(e) => e.preventDefault()}
                    className="w-full p-4 border-2 border-gray-200 rounded-lg text-lg"
                    placeholder={placeholder}
                    autoComplete="off"
                    autoCorrect="off"
                    spellCheck="false"
                    draggable="false"
                    style={{ userSelect: 'text' }}
                />
                <div className="text-green-600 font-semibold text-lg mt-1">{formatAmount(value)}</div>
                {averageAmount > 0 && (
                    <div className="text-sm text-blue-600 mt-1">
                        ğŸ“Š ë‚´ ë‚˜ì´ë˜ë˜ í‰ê· : {averageAmount.toLocaleString()}ë§Œì› (í†µê³„ì²­ ê°€ê³„ê¸ˆìœµë³µì§€ì¡°ì‚¬ 2023)
                    </div>
                )}
            </div>
        );

        // ìƒ˜í”Œ ì»¤ë®¤ë‹ˆí‹° ë°ì´í„°
        const samplePosts = [
            {
                id: 1,
                author: "ì€í‡´ì¤€ë¹„ìƒ57",
                authorProfile: { age: 57, assets: "2-5ì–µ", region: "ì„œìš¸", lifestyle: "ê· í˜•" },
                title: "3ì–µ ìì‚°ìœ¼ë¡œ ì •ë§ ì•ˆì „í•œ ì€í‡´ê°€ ê°€ëŠ¥í• ê¹Œìš”?",
                content: "ê³„ì‚°ê¸°ë¡œ ëŒë ¤ë³´ë‹ˆ ì›” 100ë§Œì› ì •ë„ ë‚˜ì˜¤ëŠ”ë°, ì‹¤ì œë¡œ ì´ ê¸ˆì•¡ìœ¼ë¡œ ì‚´ ìˆ˜ ìˆì„ì§€ ë§‰ë§‰í•©ë‹ˆë‹¤. ë¹„ìŠ·í•œ ì²˜ì§€ì—ì„œ ì€í‡´í•˜ì‹  ë¶„ë“¤ ê²½í—˜ë‹´ ë¶€íƒë“œë ¤ìš”.",
                timestamp: "2ì‹œê°„ ì „",
                likes: 12,
                replies: [
                    {
                        author: "ììœ ì¸62",
                        authorProfile: { age: 62, assets: "2-5ì–µ", region: "ë¶€ì‚°", lifestyle: "ë³´ìˆ˜ì " },
                        content: "ì €ë„ ë¹„ìŠ·í•œ ìì‚°ìœ¼ë¡œ 3ë…„ì§¸ ì€í‡´ìƒí™œ ì¤‘ì¸ë°ìš”. ì›” 100ë§Œì›ìœ¼ë¡œ ì¶©ë¶„íˆ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë‹¤ë§Œ ì—¬í–‰ì´ë‚˜ í° ì§€ì¶œì€ ë³„ë„ë¡œ ì¤€ë¹„í•´ì•¼ í•´ìš”.",
                        timestamp: "1ì‹œê°„ ì „",
                        likes: 8
                    },
                    {
                        author: "í˜„ì‹¤ì£¼ì˜59",
                        authorProfile: { age: 59, assets: "2-5ì–µ", region: "ê²½ê¸°", lifestyle: "ê· í˜•" },
                        content: "ì˜ë£Œë¹„ë¥¼ ì¢€ ë” ì—¬ìœ ìˆê²Œ ì¡ìœ¼ì‹œê¸¸ ê¶Œí•´ìš”. 50ëŒ€ í›„ë°˜ë¶€í„° ê±´ê°•ê²€ì§„ì—ì„œ ì´ê²ƒì €ê²ƒ ë‚˜ì˜¤ê¸° ì‹œì‘í•˜ë”ë¼ê³ ìš”.",
                        timestamp: "30ë¶„ ì „",
                        likes: 5
                    }
                ]
            },
            {
                id: 2,
                author: "ì „ì„¸ì‚´ì´64",
                authorProfile: { age: 64, assets: "5ì²œë§Œ-2ì–µ", region: "ì¸ì²œ", lifestyle: "ë³´ìˆ˜ì " },
                title: "ì „ì„¸ ì‚´ë©´ì„œ ë…¸í›„ ì¤€ë¹„, ì´ê²Œ ë§ë‚˜ ì‹¶ì–´ìš”",
                content: "1ì–µ ì „ì„¸ì— ì‚´ë©´ì„œ ë‚˜ë¨¸ì§€ ìì‚° 8ì²œìœ¼ë¡œ ë…¸í›„ë¥¼ ì¤€ë¹„í•˜ê³  ìˆëŠ”ë°... ì£¼ë³€ì—ì„œëŠ” ìê°€ë¥¼ ë§ˆë ¨í•˜ë¼ê³  í•˜ë„¤ìš”. ì†”ì§í•œ ì¡°ì–¸ ë¶€íƒí•©ë‹ˆë‹¤.",
                timestamp: "5ì‹œê°„ ì „",
                likes: 18,
                replies: [
                    {
                        author: "í‰ìƒì „ì„¸ëŸ¬66",
                        authorProfile: { age: 66, assets: "5ì²œë§Œ-2ì–µ", region: "ì„œìš¸", lifestyle: "ë³´ìˆ˜ì " },
                        content: "ì €ëŠ” í‰ìƒ ì „ì„¸ ì‚´ì•˜ëŠ”ë° í›„íšŒ ì—†ì–´ìš”. ê´€ë¦¬ë¹„, ìˆ˜ë¦¬ë¹„ ë“± ìˆ¨ì€ ë¹„ìš© ìƒê°í•˜ë©´ ì „ì„¸ê°€ ë‚˜ì„ ìˆ˜ë„ ìˆì–´ìš”. ë³¸ì¸ ë¼ì´í”„ìŠ¤íƒ€ì¼ì— ë§ì¶° ì„ íƒí•˜ì„¸ìš”.",
                        timestamp: "3ì‹œê°„ ì „",
                        likes: 10
                    }
                ]
            },
            {
                id: 3,
                author: "ì¡°ê¸°ì€í‡´ê¿ˆë‚˜ë¬´53",
                authorProfile: { age: 53, assets: "5-10ì–µ", region: "ëŒ€êµ¬", lifestyle: "ì ê·¹ì " },
                title: "50ëŒ€ ì´ˆë°˜ ì¡°ê¸° ì€í‡´, ë¬´ëª¨í•œ ì„ íƒì¼ê¹Œìš”?",
                content: "ë¶€ë™ì‚° 2ì±„ + ê¸ˆìœµìì‚°ìœ¼ë¡œ ì´ 7ì–µ ì •ë„. ê³„ì‚°ê¸°ë¡œëŠ” ì›” 200ë§Œì› ë‚˜ì˜¤ëŠ”ë° ì •ë§ í‡´ì‚¬í•´ë„ ë ì§€... ì¡°ê¸° ì€í‡´í•˜ì‹  ë¶„ë“¤ í˜„ì‹¤ì ì¸ ì–˜ê¸° ë“¤ë ¤ì£¼ì„¸ìš”.",
                timestamp: "8ì‹œê°„ ì „",
                likes: 25,
                replies: []
            }
        ];

        // ìƒ˜í”Œ ì„œë¹„ìŠ¤ ì œíœ´ì‚¬ ë°ì´í„°
        const partnerServices = {
            "ìƒí™œì¼€ì–´": [
                { 
                    name: "ì‹œë‹ˆì–´ í™ˆì¼€ì–´", 
                    description: "ì£¼ 2íšŒ ë°©ë¬¸ ì²­ì†Œ + ìƒí™œ ë„ì›€", 
                    price: "ì›” 25ë§Œì›ë¶€í„°",
                    dday: 7,
                    rating: 4.8,
                    reviews: 156,
                    discount: "í”Œëœë¹„ íšŒì› 10% í• ì¸",
                    detailFeatures: ["ì§‘ì•ˆ ì²­ì†Œ", "ì„¸íƒ ë° ì •ë¦¬", "ê°„ë‹¨í•œ ìš”ë¦¬ ë„ì›€", "ì™¸ì¶œ ë™í–‰"],
                    realReviews: ["í˜¼ì ì‚´ê¸° í˜ë“¤ì—ˆëŠ”ë° í° ë„ì›€ì´ ë¼ìš”", "ì§ì›ë¶„ì´ ì¹œì ˆí•˜ê³  ê¼¼ê¼¼í•´ìš”"]
                },
                { 
                    name: "ì‹¤ë²„í‘¸ë“œ", 
                    description: "ì˜ì–‘ì‚¬ ì„¤ê³„ ì‹œë‹ˆì–´ ë§ì¶¤ ë°˜ì°¬", 
                    price: "ì›” 12ë§Œì›ë¶€í„°",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.6,
                    reviews: 89,
                    discount: "ì²« ë‹¬ 50% í• ì¸",
                    detailFeatures: ["ì˜ì–‘ì‚¬ ë©”ë‰´ ì„¤ê³„", "ì €ì—¼Â·ì €ë‹¹ ë§ì¶¤", "ì£¼ 2íšŒ ë°°ì†¡", "ëƒ‰ë™ ë³´ê´€ ìš©ì´"],
                    realReviews: ["í˜¼ì ìš”ë¦¬í•˜ê¸° í˜ë“ ë° ì˜ì–‘ê°€ ìˆì–´ì„œ ì¢‹ì•„ìš”", "ê°„ì´ ì ë‹¹í•˜ê³  ë§›ìˆì–´ìš”"]
                },
                { 
                    name: "ìƒí™œìš©í’ˆ ë°°ì†¡", 
                    description: "ì‹œë‹ˆì–´ í•„ìˆ˜ ìƒí™œìš©í’ˆ ì •ê¸° ë°°ì†¡", 
                    price: "ì›” 8ë§Œì›ë¶€í„°",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.4,
                    reviews: 142,
                    discount: "3ê°œì›” êµ¬ë… ì‹œ 20% í• ì¸",
                    detailFeatures: ["í™”ì¥ì§€Â·ì„¸ì œ ë“± ìƒí•„í’ˆ", "ì˜ë£Œìš©í’ˆ í¬í•¨", "ì›” 1íšŒ ì •ê¸° ë°°ì†¡", "ê°œë³„ ë§ì¶¤ êµ¬ì„±"],
                    realReviews: ["ë¬´ê±°ìš´ ê²ƒë“¤ ì§ì ‘ ì‚¬ì§€ ì•Šì•„ë„ ë¼ì„œ í¸í•´ìš”", "í•„ìš”í•œ ê²ƒë§Œ ê³¨ë¼ì„œ ë°°ì†¡í•´ì¤˜ìš”"]
                },
                { 
                    name: "ì‹œë‹ˆì–´ IT ì„œí¬íŠ¸", 
                    description: "ìŠ¤ë§ˆíŠ¸í°Â·ì»´í“¨í„° ì‚¬ìš©ë²• 1:1 êµìœ¡", 
                    price: "íšŒë‹¹ 3ë§Œì›",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.7,
                    reviews: 78,
                    discount: "5íšŒ íŒ¨í‚¤ì§€ ì‹œ 20% í• ì¸",
                    detailFeatures: ["ë°©ë¬¸ êµìœ¡", "ìŠ¤ë§ˆíŠ¸í° ê¸°ë³¸ ì‚¬ìš©ë²•", "ì˜¨ë¼ì¸ ì‡¼í•‘ ë„ì›€", "ë¬¸ì œ í•´ê²° ì „í™” ì§€ì›"],
                    realReviews: ["ì„ ìƒë‹˜ì´ ì°¨ê·¼ì°¨ê·¼ ì•Œë ¤ì£¼ì…”ì„œ ì´í•´í•˜ê¸° ì‰¬ì›Œìš”", "ì´ì œ ì†ìì™€ ì˜ìƒí†µí™”ë„ í•  ìˆ˜ ìˆì–´ìš”"]
                }
            ],
            "ê±´ê°•ê´€ë¦¬": [
                { 
                    name: "ì¢…í•©ê±´ê°•ê²€ì§„", 
                    description: "50+ íŠ¹í™” í”„ë¦¬ë¯¸ì—„ ê²€ì§„ íŒ¨í‚¤ì§€", 
                    price: "35ë§Œì› (ì •ê°€ 50ë§Œì›)",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.9,
                    reviews: 203,
                    discount: "í”Œëœë¹„ íšŒì› íŠ¹ê°€",
                    detailFeatures: ["ì•” ì •ë°€ê²€ì‚¬", "ì‹¬ë‡Œí˜ˆê´€ ê²€ì‚¬", "ê³¨ë‹¤ê³µì¦ ê²€ì‚¬", "ì˜ì–‘ìƒë‹´ í¬í•¨"],
                    realReviews: ["ê²€ì‚¬ê°€ ê¼¼ê¼¼í•˜ê³  ê²°ê³¼ ì„¤ëª…ë„ ìì„¸í•´ìš”", "ì˜ˆì•½ë„ í¸í•˜ê³  ëŒ€ê¸°ì‹œê°„ì´ ì§§ì•„ìš”"]
                },
                { 
                    name: "ë°©ë¬¸ ë¬¼ë¦¬ì¹˜ë£Œ", 
                    description: "ê´€ì ˆÂ·ê·¼ìœ¡ ë§ì¶¤ ì¬í™œ ì¹˜ë£Œ", 
                    price: "íšŒë‹¹ 5ë§Œì›",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.6,
                    reviews: 134,
                    discount: "10íšŒ íŒ¨í‚¤ì§€ ì‹œ 15% í• ì¸",
                    detailFeatures: ["ì „ë¬¸ ë¬¼ë¦¬ì¹˜ë£Œì‚¬ ë°©ë¬¸", "ê°œë³„ ë§ì¶¤ ìš´ë™ë²•", "í†µì¦ ì™„í™” ì¹˜ë£Œ", "ì¬í™œ ìš´ë™ êµìœ¡"],
                    realReviews: ["ë¬´ë¦ í†µì¦ì´ ë§ì´ ì¢‹ì•„ì¡Œì–´ìš”", "ì§‘ì—ì„œ ë°›ì„ ìˆ˜ ìˆì–´ì„œ í¸ë¦¬í•´ìš”"]
                },
                { 
                    name: "ì‹œë‹ˆì–´ í—¬ìŠ¤ì¼€ì–´", 
                    description: "ë§ì¶¤í˜• ê±´ê°• ê´€ë¦¬ í”„ë¡œê·¸ë¨", 
                    price: "ì›” 15ë§Œì›",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.5,
                    reviews: 97,
                    discount: "6ê°œì›” ë“±ë¡ ì‹œ 1ê°œì›” ë¬´ë£Œ",
                    detailFeatures: ["ê°œì¸ë³„ ìš´ë™ í”„ë¡œê·¸ë¨", "ì˜ì–‘ ê´€ë¦¬ ìƒë‹´", "ê±´ê°• ìˆ˜ì¹˜ ëª¨ë‹ˆí„°ë§", "ì‘ê¸‰ìƒí™© ëŒ€ì‘"],
                    realReviews: ["ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬ë°›ìœ¼ë‹ˆ ê±´ê°•í•´ì§„ ê¸°ë¶„ì´ì—ìš”", "ìš´ë™ ê°•ë„ê°€ ì ë‹¹í•´ì„œ ì¢‹ì•„ìš”"]
                },
                { 
                    name: "ì¹˜ë§¤ ì˜ˆë°© ì¸ì§€í›ˆë ¨", 
                    description: "ë‘ë‡Œ í™œë™ ì¦ì§„ ì „ë¬¸ í”„ë¡œê·¸ë¨", 
                    price: "ì›” 12ë§Œì›",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.8,
                    reviews: 156,
                    discount: "ì²« ë‹¬ ì²´í—˜ 50% í• ì¸",
                    detailFeatures: ["ì¸ì§€ëŠ¥ë ¥ í‰ê°€", "ë§ì¶¤ í›ˆë ¨ í”„ë¡œê·¸ë¨", "ê·¸ë£¹ í™œë™ ì°¸ì—¬", "ì§„ì „ë„ ì •ê¸° í‰ê°€"],
                    realReviews: ["ê¸°ì–µë ¥ì´ ì¢‹ì•„ì§„ ê²ƒ ê°™ì•„ìš”", "ë‹¤ë¥¸ ë¶„ë“¤ê³¼ í•¨ê»˜ í•´ì„œ ì¬ë¯¸ìˆì–´ìš”"]
                }
            ],
            "ì—¬í–‰": [
                { 
                    name: "ì‹œë‹ˆì–´ êµ­ë‚´ ì—¬í–‰", 
                    description: "60+ ì „ìš© ì•ˆì „í•˜ê³  í¸ì•ˆí•œ êµ­ë‚´ ì—¬í–‰", 
                    price: "1ë°•2ì¼ 18ë§Œì›ë¶€í„°",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.7,
                    reviews: 167,
                    discount: "ë™ë°˜ì í• ì¸ 20%",
                    detailFeatures: ["ì˜ë£Œì§„ ë™í–‰", "íœ ì²´ì–´ ì ‘ê·¼ ê°€ëŠ¥", "ì†Œê·¸ë£¹ ë§ì¶¤ ì¼ì •", "ê°„í¸í•œ ì§ ì„œë¹„ìŠ¤"],
                    realReviews: ["ì•ˆì „í•˜ê³  í¸ì•ˆí•´ìš”", "ë™ë…„ë°°ë¼ë¦¬ ì¬ë¯¸ìˆì–´ìš”", "ê°€ì´ë“œê°€ ì„¸ì‹¬í•´ìš”"]
                },
                { 
                    name: "ì˜¨ì²œ íë§ ì—¬í–‰", 
                    description: "ê±´ê°•í•œ ì˜¨ì²œê³¼ íœ´ì–‘ì„ ê²°í•©í•œ ì—¬í–‰", 
                    price: "2ë°•3ì¼ 25ë§Œì›ë¶€í„°",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.6,
                    reviews: 143,
                    discount: "ì¡°ê¸° ì˜ˆì•½ ì‹œ 15% í• ì¸",
                    detailFeatures: ["í”„ë¦¬ë¯¸ì—„ ì˜¨ì²œ ì´ìš©", "ê±´ê°•ì‹ ì œê³µ", "ì¡±ìš•Â·ë§ˆì‚¬ì§€ í¬í•¨", "ì—¬ìœ ë¡œìš´ ì¼ì •"],
                    realReviews: ["ëª¸ë„ ë§ˆìŒë„ íë§ëì–´ìš”", "ì˜¨ì²œì´ ì •ë§ ì¢‹ë”ë¼êµ¬ìš”", "ìŒì‹ë„ ê±´ê°•í•˜ê³  ë§›ìˆì–´ìš”"]
                },
                { 
                    name: "ë¬¸í™”ìœ ì  íƒë°©", 
                    description: "ì—­ì‚¬ì™€ ë¬¸í™”ë¥¼ ë°°ìš°ëŠ” êµìœ¡í˜• ì—¬í–‰", 
                    price: "ë‹¹ì¼ 8ë§Œì›ë¶€í„°",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.4,
                    reviews: 89,
                    discount: "3íšŒ ì´ìƒ ì°¸ì—¬ ì‹œ 10% í• ì¸",
                    detailFeatures: ["ì „ë¬¸ ë¬¸í™”í•´ì„¤ì‚¬ ë™í–‰", "í¸ì•ˆí•œ ë²„ìŠ¤ ì´ë™", "ë°•ë¬¼ê´€Â·ìœ ì ì§€ íˆ¬ì–´", "ì—­ì‚¬ ìë£Œì§‘ ì œê³µ"],
                    realReviews: ["ìƒˆë¡œìš´ ê²ƒì„ ë§ì´ ë°°ì› ì–´ìš”", "í•´ì„¤ì‚¬ë‹˜ì´ ì¬ë¯¸ìˆê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš”", "ë˜ ì°¸ì—¬í•˜ê³  ì‹¶ì–´ìš”"]
                },
                { 
                    name: "ì‹œë‹ˆì–´ í¬ë£¨ì¦ˆ", 
                    description: "í¸ì•ˆí•œ ë°”ë‹¤ ì—¬í–‰ê³¼ ì„ ìƒ ì•¡í‹°ë¹„í‹°", 
                    price: "3ë°•4ì¼ 45ë§Œì›ë¶€í„°",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.8,
                    reviews: 201,
                    discount: "ì–¼ë¦¬ë²„ë“œ 30% í• ì¸",
                    detailFeatures: ["í”„ë¦¬ë¯¸ì—„ ê°ì‹¤", "ì„ ìƒ ë¬¸í™”ê³µì—°", "ê±´ê°•í•œ ë·”í˜", "ì˜ë£Œì§„ ìƒì£¼"],
                    realReviews: ["í‰ìƒ ìŠì§€ ëª»í•  ê²½í—˜ì´ì—ˆì–´ìš”", "ì„œë¹„ìŠ¤ê°€ ì •ë§ ì¢‹ì•„ìš”", "ë°”ë‹¤ ë³´ë©° íë§í–ˆì–´ìš”"]
                }
            ],
            "ì‹œë‹ˆì–´ ì¼ìë¦¬": [
                { 
                    name: "ê²½ë¹„Â·ê´€ë¦¬ ì¼ìë¦¬", 
                    description: "ì•„íŒŒíŠ¸ ê²½ë¹„Â·ê´€ë¦¬ì‚¬ë¬´ì†Œ ê·¼ë¬´", 
                    price: "ì›” 180ë§Œì›~220ë§Œì›",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.3,
                    reviews: 312,
                    discount: "ì·¨ì—… ì„±ê³µ ì‹œ ì¶•í•˜ê¸ˆ 50ë§Œì›",
                    detailFeatures: ["4ëŒ€ë³´í—˜ ì™„ë¹„", "ì£¼ë§ êµëŒ€ê·¼ë¬´", "ê²½ë ¥ ë¬´ê´€", "ì‹œë‹ˆì–´ ì¹œí™” í™˜ê²½"],
                    realReviews: ["ë™ë…„ë°°ë“¤ê³¼ ì¼í•´ì„œ í¸í•´ìš”", "ì¼ì´ ì–´ë µì§€ ì•Šì•„ì„œ ì¢‹ì•„ìš”", "ì ì •í•œ ìˆ˜ì…ì´ ìƒê²¨ì„œ ë§Œì¡±í•´ìš”"]
                },
                { 
                    name: "ì‹œë‹ˆì–´ ìƒë‹´ì‚¬", 
                    description: "ì „í™”Â·ì˜¨ë¼ì¸ ê³ ê°ìƒë‹´ ì—…ë¬´", 
                    price: "ì‹œê¸‰ 1ë§Œ2ì²œì›~1ë§Œ5ì²œì›",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.5,
                    reviews: 198,
                    discount: "êµìœ¡ ìˆ˜ë£Œ ì‹œ ì·¨ì—… ë³´ì¥",
                    detailFeatures: ["ì¬íƒ ê·¼ë¬´ ê°€ëŠ¥", "ìœ ì—°í•œ ì‹œê°„ ì„ íƒ", "ì¹œì ˆ êµìœ¡ ì œê³µ", "ì •ê¸° ìƒë‹´ ì§€ì›"],
                    realReviews: ["ì§‘ì—ì„œ ì¼í•  ìˆ˜ ìˆì–´ì„œ ì¢‹ì•„ìš”", "ì‹œê°„ ì¡°ì ˆì´ ììœ ë¡œì›Œìš”", "ì‚¬ëŒë“¤ê³¼ ëŒ€í™”í•˜ëŠ” ê²Œ ì¦ê±°ì›Œìš”"]
                },
                { 
                    name: "ê³µì›Â·í™˜ê²½ ê´€ë¦¬", 
                    description: "ê³µì› ì²­ì†ŒÂ·í™˜ê²½ ì •ë¹„ ì—…ë¬´", 
                    price: "ì›” 160ë§Œì›~200ë§Œì›",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.1,
                    reviews: 267,
                    discount: "3ê°œì›” ê·¼ë¬´ ì‹œ ì¥ê¸°ê·¼ì† ìˆ˜ë‹¹",
                    detailFeatures: ["ì•¼ì™¸ í™œë™", "ê±´ê°• ì¦ì§„", "4ëŒ€ë³´í—˜", "ê·¼ë¬´ë³µ ì§€ê¸‰"],
                    realReviews: ["ì•¼ì™¸ì—ì„œ ì¼í•˜ë‹ˆ ê±´ê°•í•´ì ¸ìš”", "ìš´ë™ë„ ë˜ê³  ìˆ˜ì…ë„ ìƒê²¨ìš”", "ë³´ëŒì°¬ ì¼ì´ì—ìš”"]
                },
                { 
                    name: "ì‹œë‹ˆì–´ ë©˜í† ë§", 
                    description: "ê²½ë ¥ ê¸°ë°˜ í›„ë°° ì§€ë„Â·ìƒë‹´", 
                    price: "íšŒë‹¹ 5ë§Œì›~10ë§Œì›",
                    dday: Math.floor(Math.random() * 30) + 1,
                    rating: 4.7,
                    reviews: 124,
                    discount: "ì •ê¸° ë©˜í†  ë“±ë¡ ì‹œ 20% ì¶”ê°€ ìˆ˜ë‹¹",
                    detailFeatures: ["ê²½ë ¥ í™œìš©", "ìœ ì—°í•œ ìŠ¤ì¼€ì¤„", "ì˜¨Â·ì˜¤í”„ë¼ì¸ ì„ íƒ", "ì „ë¬¸ì„± ì¸ì •"],
                    realReviews: ["ì œ ê²½í—˜ì„ ë‚˜ëˆŒ ìˆ˜ ìˆì–´ì„œ ë¿Œë“¯í•´ìš”", "ì Šì€ ì¹œêµ¬ë“¤ê³¼ ì†Œí†µí•˜ëŠ” ê²Œ ì¦ê±°ì›Œìš”", "ì‹œê°„ë‹¹ ìˆ˜ì…ì´ ê´œì°®ì•„ìš”"]
                }
            ]
        };

        function PlanBCommunityApp() {
            const [currentView, setCurrentView] = useState('calculator'); // calculator, community, services
            const [calculatorStep, setCalculatorStep] = useState(1);
            const [formData, setFormData] = useState({
                age: '', health: 'ë³´í†µ', mode: 'ê· í˜•',
                housingType: '', // ì£¼ê±°í˜•íƒœ: 'owned', 'jeonse', 'monthly', 'none'
                financialAssets: '', severancePay: '', 
                // ì£¼ê±° ê´€ë ¨ (ì£¼ê±°í˜•íƒœë³„ë¡œ ë‹¤ë¦„)
                homeValue: '', homeMortgage: '', jeonseDeposit: '', monthlyDeposit: '', monthlyRent: '',
                investmentRealEstate: '', investmentLoan: '', debt: '', inheritance: '',
                nationalPension: '', privatePension: '', housingPension: '', 
                // ë…¸í›„ ì›” ìˆ˜ì…
                rentalIncome: '', workIncome: '', financialIncome: '', otherIncome: '',
                // ì›” ì§€ì¶œ
                basicLiving: '', communication: '', medical: '',
                // ì›” ì´ì ì§€ì¶œ
                homeMortgageInterest: '', investmentLoanInterest: '', debtInterest: '', depositLoanInterest: '',
                // ë³´ì¦ê¸ˆ ëŒ€ì¶œ
                depositLoan: ''
            });
            const [calculatorResult, setCalculatorResult] = useState(null);
            const [averageData, setAverageData] = useState(null);
            const [selectedPost, setSelectedPost] = useState(null);
            const [communityTab, setCommunityTab] = useState('posts'); // posts, write, myprofile
            const [serviceTab, setServiceTab] = useState('ìƒí™œì¼€ì–´'); // ìƒí™œì¼€ì–´, ê±´ê°•ê´€ë¦¬, ì—¬í–‰, ì‹œë‹ˆì–´ ì¼ìë¦¬
            const [showExpenseModal, setShowExpenseModal] = useState(false);
            const [activeTab, setActiveTab] = useState('expense'); // expense, community
            const [showAssetDetail, setShowAssetDetail] = useState(false);
            const [showInheritanceGuide, setShowInheritanceGuide] = useState(false);
            const [lifeExpectancy, setLifeExpectancy] = useState(100);
            const [enableDownsizing, setEnableDownsizing] = useState(false);
            const [isResultSaved, setIsResultSaved] = useState(false);
            const [expenseData, setExpenseData] = useState({
                food: '',
                communication: '',
                utilities: '',
                living: '',
                medical: '',
                hobby: ''
            });

            const handleInputChange = (field, value) => {
                // ë¹ˆ ë¬¸ìì—´ì¼ ë•Œ 0ìœ¼ë¡œ ë³€í™˜í•˜ì§€ ì•ŠìŒ
                const cleanValue = value === '' ? '' : value;
                setFormData({ ...formData, [field]: cleanValue });
            };

            // ë‚˜ì´ ì…ë ¥ ì‹œ í‰ê·  ë°ì´í„° ì—…ë°ì´íŠ¸
            useEffect(() => {
                if (formData.age) {
                    setAverageData(getAverageDataByAge(parseInt(formData.age)));
                }
            }, [formData.age]);

            // ê¸°ëŒ€ìˆ˜ëª… ë³€ê²½ ì‹œ ê³„ì‚° ê²°ê³¼ ì—…ë°ì´íŠ¸
            useEffect(() => {
                if (calculatorResult && formData.age) {
                    // ê³„ì‚° ë‹¤ì‹œ ìˆ˜í–‰
                    calculateResults();
                    // ì„¤ì • ë³€ê²½ ì‹œ ì €ì¥ ìƒíƒœ ì´ˆê¸°í™”
                    setIsResultSaved(false);
                }
            }, [lifeExpectancy, enableDownsizing]);

            // ê³„ì‚° ê²°ê³¼ ì €ì¥ í•¨ìˆ˜
            const saveCalculationResult = () => {
                if (calculatorResult) {
                    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                    const savedResult = {
                        ...calculatorResult,
                        formData: formData,
                        lifeExpectancy: lifeExpectancy,
                        enableDownsizing: enableDownsizing,
                        savedAt: new Date().toISOString()
                    };
                    localStorage.setItem('planb_calculation_result', JSON.stringify(savedResult));
                    setIsResultSaved(true);
                    
                    // í”„ë¡œí•„ ë°ì´í„° ì—…ë°ì´íŠ¸ (ì›” ë…¸í›„ìƒí™œë¹„)
                    const existingProfile = JSON.parse(localStorage.getItem('planb_user_profile') || '{}');
                    const updatedProfile = {
                        ...existingProfile,
                        monthlyRetirementFund: calculatorResult.totalMonthlyAvailable,
                        lastUpdated: new Date().toISOString()
                    };
                    localStorage.setItem('planb_user_profile', JSON.stringify(updatedProfile));
                }
            };

            const calculateResults = () => {
                const age = parseInt(formData.age);
                
                // ìì‚° ê³„ì‚° (ë§Œì› â†’ ì›)
                // ì£¼ê±°í˜•íƒœë³„ ìì‚° ê³„ì‚°
                let housingAsset = 0;
                let housingDebt = 0;
                let monthlyHousingCost = 0;
                
                // ì›” ëŒ€ì¶œ ì´ì (ê°œë³„ í•©ì‚°)
                const monthlyLoanInterest = 
                    ((parseInt(formData.homeMortgageInterest) || 0) + 
                     (parseInt(formData.investmentLoanInterest) || 0) + 
                     (parseInt(formData.debtInterest) || 0) + 
                     (parseInt(formData.depositLoanInterest) || 0)) * 10000;
                
                if (formData.housingType === 'owned_living') {
                    // ìê°€ ì†Œìœ  + ê±°ì£¼: ì§‘ê°’ - ëŒ€ì¶œ
                    housingAsset = (parseInt(formData.homeValue) || 0) * 10000;
                    housingDebt = (parseInt(formData.homeMortgage) || 0) * 10000;
                } else if (formData.housingType === 'owned_renting') {
                    // ìê°€ ì†Œìœ  + ì „ì„¸/ì›”ì„¸ ê±°ì£¼: ì†Œìœ í•œ ì§‘ì€ ì„ëŒ€ìš© ìì‚°ìœ¼ë¡œ ê³„ì‚°
                    housingAsset = (parseInt(formData.homeValue) || 0) * 10000;
                    housingDebt = (parseInt(formData.homeMortgage) || 0) * 10000;
                    if (formData.currentRentType === 'monthly') {
                        monthlyHousingCost = (parseInt(formData.currentRent) || 0) * 10000;
                    }
                } else if (formData.housingType === 'jeonse') {
                    // ì „ì„¸: ë³´ì¦ê¸ˆë§Œ ìì‚°
                    housingAsset = (parseInt(formData.jeonseDeposit) || 0) * 10000;
                } else if (formData.housingType === 'monthly') {
                    // ì›”ì„¸: ë³´ì¦ê¸ˆë§Œ ìì‚°, ì›”ì„¸ëŠ” ì§€ì¶œ
                    housingAsset = (parseInt(formData.monthlyDeposit) || 0) * 10000;
                    monthlyHousingCost = (parseInt(formData.monthlyRent) || 0) * 10000;
                }
                // ë¬´ì£¼íƒ('none')ì€ ì£¼ê±° ê´€ë ¨ ìì‚° 0
                
                const assets = {
                    financial: (parseInt(formData.financialAssets) || 0) * 10000,
                    severance: (parseInt(formData.severancePay) || 0) * 10000,
                    housing: housingAsset,
                    currentDeposit: (parseInt(formData.currentDeposit) || 0) * 10000,
                    housingDebt: housingDebt,
                    monthlyHousingCost: monthlyHousingCost,
                    investment: (parseInt(formData.investmentRealEstate) || 0) * 10000,
                    investmentLoan: (parseInt(formData.investmentLoan) || 0) * 10000,
                    debt: (parseInt(formData.debt) || 0) * 10000,
                    depositLoan: (parseInt(formData.depositLoan) || 0) * 10000,
                    inheritance: (parseInt(formData.inheritance) || 0) * 10000
                };
                
                // ì£¼ê±°í˜•íƒœë³„ ìì‚° ë°˜ì˜ ë¹„ìœ¨
                const housingPensionAmount = (parseInt(formData.housingPension) || 0);
                let housingValueRatio = 0;
                
                if (formData.housingType === 'owned_living') {
                    // ìê°€ + ê±°ì£¼: ì£¼íƒì—°ê¸ˆ ìˆìœ¼ë©´ 100%, ì£¼íƒ ë§¤ê°ì‹œ 75%(ì–‘ë„ì„¸+ìˆ˜ìˆ˜ë£Œ ê³ ë ¤), ì—†ìœ¼ë©´ 0%
                    if (housingPensionAmount > 0) {
                        housingValueRatio = 1.0;
                    } else if (enableDownsizing) {
                        housingValueRatio = 0.75; // ì£¼íƒ ë§¤ê° ì‹œ ì–‘ë„ì„¸+ìˆ˜ìˆ˜ë£Œ 25% ì°¨ê°
                    } else {
                        housingValueRatio = 0; // ê±°ì£¼ìš© ì£¼íƒì€ ìƒí™œë¹„ë¡œ ì‚¬ìš© ë¶ˆê°€
                    }
                } else if (formData.housingType === 'owned_renting') {
                    // ìê°€ + ì „ì„¸/ì›”ì„¸ ê±°ì£¼: ì£¼íƒ ë§¤ê°ì‹œ 75%, ì•„ë‹ˆë©´ 0%
                    if (enableDownsizing) {
                        housingValueRatio = 0.75; // ì£¼íƒ ë§¤ê° ì‹œ ì–‘ë„ì„¸+ìˆ˜ìˆ˜ë£Œ 25% ì°¨ê°
                    } else {
                        housingValueRatio = 0; // ì„ëŒ€ìš© ì£¼íƒë„ ë§¤ê°í•˜ì§€ ì•Šìœ¼ë©´ ìƒí™œë¹„ë¡œ ì‚¬ìš© ë¶ˆê°€
                    }
                } else if (formData.housingType === 'jeonse' || formData.housingType === 'monthly') {
                    // ì „ì„¸/ì›”ì„¸: ë³´ì¦ê¸ˆì€ 100% ìì‚°
                    housingValueRatio = 1.0;
                }
                // ë¬´ì£¼íƒ: 0% (ìë™ìœ¼ë¡œ 0)
                
                // ìƒì†/ì¦ì—¬ ì˜ˆì •ì•¡ê³¼ ì„ì°¨ì¸ ë³´ì¦ê¸ˆì€ ì²˜ìŒë¶€í„° ì œì™¸
                const ownedHouseDepositDebt = (parseInt(formData.ownedHouseDeposit) || 0) * 10000; // ì„ì°¨ì¸ ë³´ì¦ê¸ˆ (ëŒë ¤ì¤˜ì•¼ í•  ëˆ)
                
                // ì£¼íƒ ë§¤ê° ì‹œ ì‹¤ì œ ë§¤ê° ê°€ëŠ¥ ê¸ˆì•¡ ê³„ì‚°
                let realizedHousingAsset = 0;
                if (formData.housingType === 'owned_living' && enableDownsizing) {
                    // ìê°€ ê±°ì£¼ + ì£¼íƒ ë§¤ê°: (ì§‘ê°’ Ã— 75%) - ì£¼íƒë‹´ë³´ëŒ€ì¶œ
                    realizedHousingAsset = Math.max(0, (assets.housing * housingValueRatio) - assets.housingDebt);
                } else if (formData.housingType === 'owned_renting' && enableDownsizing) {
                    // ìê°€ ì†Œìœ  + ì „ì„¸/ì›”ì„¸ ê±°ì£¼ + ì£¼íƒ ë§¤ê°: (ì§‘ê°’ Ã— 75%) - ì„ì°¨ì¸ë³´ì¦ê¸ˆ - ì£¼íƒë‹´ë³´ëŒ€ì¶œ
                    realizedHousingAsset = Math.max(0, (assets.housing * housingValueRatio) - ownedHouseDepositDebt - assets.housingDebt);
                } else {
                    // ì¼ë°˜ì ì¸ ê²½ìš°: ê¸°ì¡´ ë¡œì§ ìœ ì§€ (ë§¤ê°í•˜ì§€ ì•Šìœ¼ë©´ 0)
                    realizedHousingAsset = assets.housing * housingValueRatio;
                }
                
                // ì£¼íƒì—°ê¸ˆ ì„ íƒ ì‹œ ì£¼íƒ ìì‚° ì²˜ë¦¬
                let housingAssetForUsable = realizedHousingAsset;
                if (parseInt(formData.housingPension) > 0) {
                    // ì£¼íƒì—°ê¸ˆ ì„ íƒ ì‹œ í•´ë‹¹ ì£¼íƒì€ ìì‚°ì—ì„œ ì™„ì „ ë°°ì œ (ì†Œë“ìœ¼ë¡œ ì „í™˜)
                    housingAssetForUsable = 0;
                }
                
                // ìƒí™œë¹„ë¡œ ì“¸ ìˆ˜ ìˆëŠ” ìì‚° ê³„ì‚° (ë¶€ì±„ ì°¨ê° ì „)
                // ê±°ì£¼ì§€ ë³´ì¦ê¸ˆì€ ìƒí™œë¹„ë¡œ ì“¸ ìˆ˜ ì—†ëŠ” ìì‚°ì´ë¯€ë¡œ ì œì™¸
                const usableAssetsGross = assets.financial + assets.severance + housingAssetForUsable;
                
                // ìƒí™œë¹„ë¡œ ì“¸ ìˆ˜ ìˆëŠ” ìì‚° (ë¶€ì±„ ì°¨ê° ì•ˆ í•¨)
                const usableAssets = usableAssetsGross;
                
                // ë¶€ì±„ ì •ë³´ (ì°¸ê³ ìš©)
                const totalDebts = (enableDownsizing ? 0 : assets.housingDebt) + assets.investmentLoan + assets.debt + assets.depositLoan +
                    (enableDownsizing && formData.housingType === 'owned_renting' ? 0 : ownedHouseDepositDebt);
                
                // ë””ë²„ê¹…ìš© - ë‚˜ì¤‘ì— ì œê±°
                console.log('ê³„ì‚° í™•ì¸:', {
                    'í˜„ê¸ˆì„±ìì‚°': assets.financial,
                    'í‡´ì§ê¸ˆ': assets.severance,
                    'ì£¼íƒë§¤ê°ê¸ˆ': realizedHousingAsset,
                    'ê±°ì£¼ì§€ë³´ì¦ê¸ˆ': assets.currentDeposit,
                    'ì£¼íƒì—°ê¸ˆ': parseInt(formData.housingPension) > 0 ? (parseInt(formData.homeValue) || 0) * 10000 : 0,
                    usableAssetsGross,
                    'ì£¼íƒëŒ€ì¶œ': assets.housingDebt,
                    'íˆ¬ìëŒ€ì¶œ': assets.investmentLoan,
                    'ê¸°íƒ€ëŒ€ì¶œ': assets.debt,
                    'ì„ì°¨ì¸ë³´ì¦ê¸ˆ': enableDownsizing && formData.housingType === 'owned_renting' ? 0 : ownedHouseDepositDebt,
                    totalDebts, 
                    usableAssets,
                    emergencyFund: assets.financial * 0.1
                });
                
                // ìƒí™œë¹„ë¡œ ì“¸ ìˆ˜ ì—†ëŠ” ìì‚° ê³„ì‚°
                const unusableAssets = assets.investment + assets.inheritance +
                    (!enableDownsizing && !parseInt(formData.housingPension) && parseInt(formData.homeValue) > 0 ? (parseInt(formData.homeValue) || 0) * 10000 : 0);
                
                // ì´ìì‚° = ëª¨ë“  ìì‚°ì˜ í•© - ë¶€ì±„
                const allAssets = assets.financial + assets.severance + assets.housing + assets.currentDeposit + assets.investment + assets.inheritance;
                const totalAssets = Math.max(0, allAssets - totalDebts);
                
                // ë””ë²„ê¹…ìš©
                console.log('ì´ìì‚° ê³„ì‚°:', {
                    'í˜„ê¸ˆì„±ìì‚°': assets.financial,
                    'í‡´ì§ê¸ˆ': assets.severance, 
                    'ì£¼íƒìì‚°': assets.housing,
                    'ê±°ì£¼ì§€ë³´ì¦ê¸ˆ': assets.currentDeposit,
                    'ìˆ˜ìµí˜•ë¶€ë™ì‚°': assets.investment,
                    'ì¦ì—¬ìƒì†': assets.inheritance,
                    'allAssets': allAssets,
                    'totalDebts': totalDebts,
                    'totalAssets': totalAssets
                });
                
                // ë¹„ìƒìê¸ˆì€ í˜„ê¸ˆì„± ìì‚°ì˜ 10%
                const emergencyFund = assets.financial * 0.1;
                const availableAssets = Math.max(0, usableAssets - emergencyFund);
                
                // ë‹¨ìˆœ ì†Œì§„ ê³„ì‚° (íˆ¬ììˆ˜ìµë¥  ë°°ì œ)
                const yearsToLive = lifeExpectancy - age;
                const annualWithdrawal = availableAssets / yearsToLive;
                const dailyAmount = annualWithdrawal / 365;
                const monthlyAmount = annualWithdrawal / 12;
                
                // ì—°ê¸ˆ ìˆ˜ì… (ì°¸ê³ ìš©)
                const monthlyPension = (parseInt(formData.nationalPension) || 0) + (parseInt(formData.privatePension) || 0) + (parseInt(formData.housingPension) || 0);
                
                // ë…¸í›„ ì›” ìˆ˜ì… (ì°¸ê³ ìš©)
                const monthlyOtherIncome = (parseInt(formData.rentalIncome) || 0) + (parseInt(formData.workIncome) || 0) + (parseInt(formData.financialIncome) || 0) + (parseInt(formData.otherIncome) || 0);
                
                // ì´ ê°€ìš© ì§€ì¶œ ê¸ˆì•¡ = ìƒí™œë¹„ë¡œ ì“¸ ìˆ˜ ìˆëŠ” ìì‚° + ì—°ê¸ˆ ìˆ˜ì… + ê¸°íƒ€ ì›” ìˆ˜ì… - ì›”ì„¸ - ëŒ€ì¶œì´ì (ëª¨ë‘ ì› ë‹¨ìœ„)
                const totalMonthlyAvailable = Math.round(monthlyAmount) + (monthlyPension * 10000) + (monthlyOtherIncome * 10000) - monthlyHousingCost - monthlyLoanInterest;
                const totalDailyAvailable = Math.round(totalMonthlyAvailable / 30.4);
                
                // ë””ë²„ê¹…ìš© - ë‚˜ì¤‘ì— ì œê±°  
                console.log('setCalculatorResult í˜¸ì¶œ:', { usableAssets, availableAssets });
                
                setCalculatorResult({
                    // ìƒí™œë¹„ë¡œ ì“¸ ìˆ˜ ìˆëŠ” ìì‚°
                    dailyAmount: Math.round(dailyAmount),
                    monthlyAmount: Math.round(monthlyAmount),
                    annualAmount: Math.round(annualWithdrawal),
                    
                    // ì´ ê°€ìš© ì§€ì¶œ ê¸ˆì•¡ (ìì‚° + ì—°ê¸ˆ + ê¸°íƒ€ ìˆ˜ì…)
                    totalDailyAvailable: totalDailyAvailable,
                    totalMonthlyAvailable: Math.round(totalMonthlyAvailable),
                    
                    yearsToLive: yearsToLive,
                    
                    // ìì‚° ì„¸ë¶€ì‚¬í•­
                    assetBreakdown: {
                        totalAssets, usableAssets, usableAssetsGross, unusableAssets, availableAssets, emergencyFund, totalDebts,
                        financial: assets.financial, severance: assets.severance,
                        housing: assets.housing, realizedHousingAsset: realizedHousingAsset, currentDeposit: assets.currentDeposit, housingDebt: assets.housingDebt, housingValueRatio: housingValueRatio,
                        monthlyHousingCost: assets.monthlyHousingCost,
                        investment: assets.investment, investmentLoan: assets.investmentLoan,
                        debt: assets.debt, inheritance: assets.inheritance, 
                        housingPensionAmount: housingPensionAmount,
                        housingType: formData.housingType,
                        enableDownsizing: enableDownsizing,
                        ownedHouseDepositDebt: ownedHouseDepositDebt
                    },
                    
                    // ì°¸ê³  ì •ë³´
                    monthlyPension: monthlyPension * 10000,
                    monthlyOtherIncome: monthlyOtherIncome * 10000,
                    monthlyHousingCost: monthlyHousingCost,
                    monthlyLoanInterest: monthlyLoanInterest,
                    
                    safetyLevel: totalMonthlyAvailable >= 3000000 ? 'ì•ˆì „' : totalMonthlyAvailable >= 1500000 ? 'ë³´í†µ' : 'ì£¼ì˜'
                });
                
                // í”„ë¡œí•„ ì—…ë°ì´íŠ¸ (ê³„ì‚°ê¸° ê²°ê³¼ ì—°ë™)
                const currentProfile = JSON.parse(localStorage.getItem('planb_profile') || '{}');
                const updatedProfile = {
                    ...currentProfile,
                    age: parseInt(formData.age),
                    assets: getAssetGroup(totalAssets),
                    lifestyle: formData.mode, // ìƒí™œëª¨ë“œ
                    health: formData.health, // ê±´ê°•ìƒíƒœ
                    monthlyRetirementBudget: Math.round(totalMonthlyAvailable / 10000) // ì›” ë…¸í›„ìƒí™œë¹„ (ë§Œì› ë‹¨ìœ„)
                };
                localStorage.setItem('planb_profile', JSON.stringify(updatedProfile));
                
                setCalculatorStep(4);
            };

            const getAssetGroup = (assets) => {
                if (assets >= 1000000) return "10ì–µ ì´ìƒ";
                if (assets >= 500000) return "5-10ì–µ";
                if (assets >= 200000) return "2-5ì–µ";
                if (assets >= 50000) return "5ì²œë§Œ-2ì–µ";
                return "5ì²œë§Œ ë¯¸ë§Œ";
            };

            const joinCommunity = () => {
                // ê³„ì‚° ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì»¤ë®¤ë‹ˆí‹° í”„ë¡œí•„ ìƒì„±
                const profile = {
                    age: formData.age,
                    assets: getAssetGroup(parseInt(formData.assets)),
                    region: formData.region,
                    lifestyle: formData.lifestyle,
                    monthlyBudget: calculatorResult.monthlyAmount,
                    joinDate: new Date().toLocaleDateString()
                };
                
                localStorage.setItem('planb_profile', JSON.stringify(profile));
                setCurrentView('community');
            };

            const openExpenseModal = () => {
                setShowExpenseModal(true);
            };

            const closeExpenseModal = () => {
                setShowExpenseModal(false);
            };

            const handleExpenseChange = (field, value) => {
                setExpenseData({ ...expenseData, [field]: value });
            };

            const submitExpenseData = () => {
                // Here we would normally submit to a backend
                alert('ì§€ì¶œë‚´ì—­ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ì´ì œ ë¹„ìŠ·í•œ ì‚¬ëŒë“¤ì˜ ì§€ì¶œ íŒ¨í„´ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                setShowExpenseModal(false);
                // Could redirect to a comparison view or show analytics
            };

            const renderCalculator = () => {
                if (calculatorStep === 1) {
                    return (
                        <div className="min-h-screen py-8 px-4">
                            <div className="max-w-2xl mx-auto">
                                <div className="text-center mb-8">
                                    <h1 className="text-3xl font-bold text-gray-800 mb-3">ğŸ§® ë…¸í›„ìƒí™œë¹„ ê³„ì‚°ê¸°</h1>
                                    <p className="text-xl text-gray-600">ë‚˜ì´ì™€ ê±´ê°•ìƒíƒœë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
                                    <div className="w-full bg-gray-200 rounded-full h-4 mt-6 max-w-md mx-auto">
                                        <div className="bg-blue-600 h-4 rounded-full" style={{width: '33%'}}></div>
                                    </div>
                                    <p className="text-lg text-gray-500 mt-3">1ë‹¨ê³„ / 3ë‹¨ê³„</p>
                                </div>

                                <div className="card">
                                    <div className="space-y-6">
                                        <div className="mb-6">
                                            <label className="block text-xl font-semibold text-gray-800 mb-3">ğŸ‚ ë‚˜ì´</label>
                                            <input
                                                type="text"
                                                inputMode="numeric"
                                                pattern="[0-9]*"
                                                value={formData.age}
                                                onChange={(e) => {
                                                    const numValue = e.target.value.replace(/[^0-9]/g, '');
                                                    handleInputChange('age', Math.max(0, numValue));
                                                }}
                                                onDragStart={(e) => e.preventDefault()}
                                                onDrop={(e) => e.preventDefault()}
                                                onDragOver={(e) => e.preventDefault()}
                                                className="w-full p-4 border-2 border-gray-200 rounded-lg text-lg"
                                                placeholder=""
                                                autoComplete="off"
                                                autoCorrect="off"
                                                spellCheck="false"
                                                draggable="false"
                                                style={{ userSelect: 'text' }}
                                            />
                                        </div>

                                        <div>
                                            <label className="block text-xl font-semibold text-gray-800 mb-3">ğŸ’ª ê±´ê°• ìƒíƒœ</label>
                                            <select
                                                className="w-full p-4 border-2 border-gray-200 rounded-lg text-lg"
                                                value={formData.health}
                                                onChange={(e) => handleInputChange('health', e.target.value)}
                                            >
                                                <option value="ì–‘í˜¸">ì–‘í˜¸ (ìš´ë™ ê·œì¹™ì , í° ì§ˆë³‘ ì—†ìŒ)</option>
                                                <option value="ë³´í†µ">ë³´í†µ (ì¼ë°˜ì ì¸ ê±´ê°• ìƒíƒœ)</option>
                                                <option value="ì£¼ì˜í•„ìš”">ì£¼ì˜í•„ìš” (ë§Œì„±ì§ˆí™˜ ìˆê±°ë‚˜ ê´€ë¦¬ í•„ìš”)</option>
                                            </select>
                                        </div>

                                        <div>
                                            <label className="block text-xl font-semibold text-gray-800 mb-3">ğŸ¯ ìƒí™œ ëª¨ë“œ</label>
                                            <select
                                                className="w-full p-4 border-2 border-gray-200 rounded-lg text-lg"
                                                value={formData.mode}
                                                onChange={(e) => handleInputChange('mode', e.target.value)}
                                            >
                                                <option value="ë³´ìˆ˜ì ">ë³´ìˆ˜ì  (ì•ˆì „ ìš°ì„ , ì—¬ìœ ìê¸ˆ í™•ë³´)</option>
                                                <option value="ê· í˜•">ê· í˜• (í‰ê· ì ì¸ ìƒí™œ ìˆ˜ì¤€ ìœ ì§€)</option>
                                                <option value="ì ê·¹ì ">ì ê·¹ì  (ì—¬ìœ ìˆëŠ” ìƒí™œ, ì·¨ë¯¸í™œë™)</option>
                                            </select>
                                        </div>

                                        <button
                                            onClick={() => setCalculatorStep(2)}
                                            className="btn-primary w-full text-xl py-4"
                                            disabled={!formData.age || !formData.health || !formData.mode}
                                        >
                                            ë‹¤ìŒ ë‹¨ê³„ â†’
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    );
                }

                if (calculatorStep === 2) {
                    return (
                        <div className="min-h-screen py-8 px-4">
                            <div className="max-w-2xl mx-auto">
                                <div className="text-center mb-8">
                                    <h1 className="text-3xl font-bold text-gray-800 mb-3">ğŸ  ìì‚° ì •ë³´</h1>
                                    <p className="text-xl text-gray-600">í˜„ì¬ ë³´ìœ í•˜ê³  ê³„ì‹  ìì‚°ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
                                    <div className="w-full bg-gray-200 rounded-full h-4 mt-6 max-w-md mx-auto">
                                        <div className="bg-blue-600 h-4 rounded-full" style={{width: '66%'}}></div>
                                    </div>
                                    <p className="text-lg text-gray-500 mt-3">2ë‹¨ê³„ / 3ë‹¨ê³„</p>
                                </div>

                                <div className="card">
                                    <div className="bg-green-50 border-l-4 border-green-400 p-6 mb-8 rounded-r-lg">
                                        <p className="text-lg text-green-800">
                                            ğŸ˜Š <strong>ì •í™•í•œ ìˆ˜ì¹˜ë¥¼ ëª¨ë¥´ì‹œëŠ” ê²½ìš°ì—ëŠ”</strong><br/>
                                            ì•Œê³  ê³„ì‹  ëŒ€ëµì ì¸ ê¸ˆì•¡ì„ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤.
                                        </p>
                                    </div>

                                    <div className="space-y-6">
                                        <div>
                                            <label className="block text-xl font-semibold text-gray-800 mb-3">ğŸ  ì£¼ê±° í˜•íƒœ</label>
                                            <select
                                                className="w-full p-4 border-2 border-gray-200 rounded-lg text-lg"
                                                value={formData.housingType}
                                                onChange={(e) => handleInputChange('housingType', e.target.value)}
                                            >
                                                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                                <option value="owned_living">ìê°€ ì†Œìœ  + ê±°ì£¼</option>
                                                <option value="owned_renting">ìê°€ ì†Œìœ  + ì „ì„¸/ì›”ì„¸ ê±°ì£¼</option>
                                                <option value="jeonse">ì „ì„¸</option>
                                                <option value="monthly">ì›”ì„¸</option>
                                                <option value="none">ë¬´ì£¼íƒ</option>
                                            </select>
                                        </div>

                                        <AmountInput
                                            label="ğŸ¦ í˜„ê¸ˆ ë° í˜„ê¸ˆì„± ìì‚° (ì˜ˆê¸ˆÂ·ì ê¸ˆÂ·ì£¼ì‹Â·í€ë“œ ë“±, ë‹¨ìœ„: ë§Œì›)"
                                            value={formData.financialAssets}
                                            onChange={(v) => handleInputChange('financialAssets', v)}
                                            placeholder=""
                                            averageAmount={averageData?.financialAssets || 0}
                                        />

                                        <AmountInput
                                            label="ğŸ’¼ í‡´ì§ê¸ˆ (ì€í‡´ì‹œ ë°›ì„ í‡´ì§ê¸ˆ ë˜ëŠ” í˜„ì¬ ë‚¨ì•„ìˆëŠ” í‡´ì§ê¸ˆ, ë‹¨ìœ„: ë§Œì›)"
                                            value={formData.severancePay}
                                            onChange={(v) => handleInputChange('severancePay', v)}
                                            placeholder=""
                                            averageAmount={averageData?.severancePay || 0}
                                        />

                                        {/* ì£¼ê±°í˜•íƒœë³„ ì¡°ê±´ë¶€ í•„ë“œ */}
                                        {(formData.housingType === 'owned_living' || formData.housingType === 'owned_renting') && (
                                            <>
                                                <AmountInput
                                                    label="ğŸ  ìê°€ ì†Œìœ  ì£¼íƒ ì‹œì„¸ (ë‹¨ìœ„: ë§Œì›)"
                                                    value={formData.homeValue}
                                                    onChange={(v) => handleInputChange('homeValue', v)}
                                                    placeholder=""
                                                    averageAmount={averageData?.homeValue || 0}
                                                />
                                                <AmountInput
                                                    label="ğŸ  ì£¼íƒë‹´ë³´ëŒ€ì¶œ ì”ì•¡ (ë‹¨ìœ„: ë§Œì›)"
                                                    value={formData.homeMortgage}
                                                    onChange={(v) => handleInputChange('homeMortgage', v)}
                                                    placeholder=""
                                                    averageAmount={0}
                                                />
                                                {formData.homeMortgage && parseInt(formData.homeMortgage) > 0 && (
                                                    <AmountInput
                                                        label="ğŸ’³ ì£¼íƒë‹´ë³´ëŒ€ì¶œ ì›” ì´ì (ë‹¨ìœ„: ë§Œì›)"
                                                        value={formData.homeMortgageInterest}
                                                        onChange={(v) => handleInputChange('homeMortgageInterest', v)}
                                                        placeholder=""
                                                        averageAmount={0}
                                                    />
                                                )}
                                            </>
                                        )}

                                        {formData.housingType === 'owned_renting' && (
                                            <>

                                                <AmountInput
                                                    label="ğŸ  ë‚´ ì†Œìœ  ì§‘ ì„ì°¨ì¸ ë³´ì¦ê¸ˆ (ë‚´ê°€ ë°›ì€ ë³´ì¦ê¸ˆ, ë‹¨ìœ„: ë§Œì›)"
                                                    value={formData.ownedHouseDeposit}
                                                    onChange={(v) => handleInputChange('ownedHouseDeposit', v)}
                                                    placeholder=""
                                                    averageAmount={0}
                                                />

                                                <AmountInput
                                                    label="ğŸ  í˜„ì¬ ê±°ì£¼ì§€ ë³´ì¦ê¸ˆ (ë‚´ê°€ ë‚¸ ë³´ì¦ê¸ˆ, ë‹¨ìœ„: ë§Œì›)"
                                                    value={formData.currentDeposit}
                                                    onChange={(v) => handleInputChange('currentDeposit', v)}
                                                    placeholder=""
                                                    averageAmount={0}
                                                />
                                                
                                                <AmountInput
                                                    label="ğŸ’³ ë³´ì¦ê¸ˆ ëŒ€ì¶œ ì”ì•¡ (ë‹¨ìœ„: ë§Œì›)"
                                                    value={formData.depositLoan}
                                                    onChange={(v) => handleInputChange('depositLoan', v)}
                                                    placeholder=""
                                                    averageAmount={0}
                                                />
                                                {formData.depositLoan && parseInt(formData.depositLoan) > 0 && (
                                                    <AmountInput
                                                        label="ğŸ’³ ë³´ì¦ê¸ˆ ëŒ€ì¶œ ì›” ì´ì (ë‹¨ìœ„: ë§Œì›)"
                                                        value={formData.depositLoanInterest}
                                                        onChange={(v) => handleInputChange('depositLoanInterest', v)}
                                                        placeholder=""
                                                        averageAmount={0}
                                                    />
                                                )}

                                                <div className="mb-6">
                                                    <label className="block text-xl font-semibold text-gray-800 mb-3">ğŸ  í˜„ì¬ ê±°ì£¼ í˜•íƒœ</label>
                                                    <select
                                                        className="w-full p-4 border-2 border-gray-200 rounded-lg text-lg"
                                                        value={formData.currentRentType}
                                                        onChange={(e) => handleInputChange('currentRentType', e.target.value)}
                                                    >
                                                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                                        <option value="jeonse">ì „ì„¸</option>
                                                        <option value="monthly">ì›”ì„¸</option>
                                                    </select>
                                                </div>

                                                {formData.currentRentType === 'monthly' && (
                                                    <AmountInput
                                                        label="ğŸ  í˜„ì¬ ê±°ì£¼ì§€ ì›”ì„¸ (ë‚´ê°€ ë‚´ëŠ” ì›”ì„¸, ë‹¨ìœ„: ë§Œì›)"
                                                        value={formData.currentRent}
                                                        onChange={(v) => handleInputChange('currentRent', v)}
                                                        placeholder=""
                                                        averageAmount={0}
                                                    />
                                                )}
                                            </>
                                        )}

                                        {formData.housingType === 'jeonse' && (
                                            <AmountInput
                                                label="ğŸ  ì „ì„¸ë³´ì¦ê¸ˆ (ë‹¨ìœ„: ë§Œì›)"
                                                value={formData.jeonseDeposit}
                                                onChange={(v) => handleInputChange('jeonseDeposit', v)}
                                                placeholder=""
                                                averageAmount={0}
                                            />
                                        )}

                                        {formData.housingType === 'monthly' && (
                                            <>
                                                <AmountInput
                                                    label="ğŸ  ì›”ì„¸ë³´ì¦ê¸ˆ (ë‹¨ìœ„: ë§Œì›)"
                                                    value={formData.monthlyDeposit}
                                                    onChange={(v) => handleInputChange('monthlyDeposit', v)}
                                                    placeholder=""
                                                    averageAmount={0}
                                                />
                                                <AmountInput
                                                    label="ğŸ  ì›”ì„¸ (ë‹¨ìœ„: ë§Œì›)"
                                                    value={formData.monthlyRent}
                                                    onChange={(v) => handleInputChange('monthlyRent', v)}
                                                    placeholder=""
                                                    averageAmount={0}
                                                />
                                            </>
                                        )}

                                        <AmountInput
                                            label="ğŸ¢ ìˆ˜ìµí˜• ë¶€ë™ì‚° (ì˜¤í”¼ìŠ¤í…”Â·ìƒê°€ ë“±, ë‹¨ìœ„: ë§Œì›)"
                                            value={formData.investmentRealEstate}
                                            onChange={(v) => handleInputChange('investmentRealEstate', v)}
                                            placeholder=""
                                            averageAmount={0}
                                        />

                                        <AmountInput
                                            label="ğŸ¢ ìˆ˜ìµí˜• ë¶€ë™ì‚° ëŒ€ì¶œ ì”ì•¡ (ë‹¨ìœ„: ë§Œì›)"
                                            value={formData.investmentLoan}
                                            onChange={(v) => handleInputChange('investmentLoan', v)}
                                            placeholder=""
                                            averageAmount={0}
                                        />
                                        {formData.investmentLoan && parseInt(formData.investmentLoan) > 0 && (
                                            <AmountInput
                                                label="ğŸ’³ ìˆ˜ìµí˜• ë¶€ë™ì‚° ëŒ€ì¶œ ì›” ì´ì (ë‹¨ìœ„: ë§Œì›)"
                                                value={formData.investmentLoanInterest}
                                                onChange={(v) => handleInputChange('investmentLoanInterest', v)}
                                                placeholder=""
                                                averageAmount={0}
                                            />
                                        )}

                                        <AmountInput
                                            label="ğŸ’³ ê¸°íƒ€ ëŒ€ì¶œ ì”ì•¡ (ë‹¨ìœ„: ë§Œì›)"
                                            value={formData.debt}
                                            onChange={(v) => handleInputChange('debt', v)}
                                            placeholder=""
                                            averageAmount={averageData?.debt || 0}
                                        />
                                        {formData.debt && parseInt(formData.debt) > 0 && (
                                            <AmountInput
                                                label="ğŸ’³ ê¸°íƒ€ ëŒ€ì¶œ ì›” ì´ì (ë‹¨ìœ„: ë§Œì›)"
                                                value={formData.debtInterest}
                                                onChange={(v) => handleInputChange('debtInterest', v)}
                                                placeholder=""
                                                averageAmount={0}
                                            />
                                        )}

                                        <div className="mb-6">
                                            <div className="flex items-center gap-2 mb-3">
                                                <label className="block text-xl font-semibold text-gray-800">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ê°€ì¡± ì¦ì—¬ ë˜ëŠ” ìƒì† ì˜ˆì •ì•¡ (ë‹¨ìœ„: ë§Œì›)</label>
                                                <button
                                                    onClick={() => setShowInheritanceGuide(!showInheritanceGuide)}
                                                    className="text-blue-500 bg-blue-50 rounded-full w-6 h-6 flex items-center justify-center text-sm hover:bg-blue-100"
                                                >
                                                    ?
                                                </button>
                                            </div>
                                            <input
                                                type="text"
                                                inputMode="numeric"
                                                pattern="[0-9]*"
                                                value={formData.inheritance}
                                                onChange={(e) => {
                                                    const numValue = e.target.value.replace(/[^0-9]/g, '');
                                                    handleInputChange('inheritance', numValue === '' ? '' : numValue);
                                                }}
                                                onDragStart={(e) => e.preventDefault()}
                                                onDrop={(e) => e.preventDefault()}
                                                onDragOver={(e) => e.preventDefault()}
                                                className="w-full p-4 border-2 border-gray-200 rounded-lg text-lg"
                                                placeholder=""
                                                autoComplete="off"
                                                autoCorrect="off"
                                                spellCheck="false"
                                                draggable="false"
                                            />
                                            <div className="text-green-600 font-semibold text-lg mt-1">{formatAmount(formData.inheritance)}</div>
                                            
                                            {showInheritanceGuide && (
                                                <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 mt-3 rounded-r-lg">
                                                    <div className="text-yellow-800">
                                                        <p className="font-semibold mb-2">ğŸ“Š ì°¸ê³  ê°€ì´ë“œë¼ì¸</p>
                                                        <ul className="text-sm space-y-1">
                                                            <li>â€¢ <strong>ìƒì•  í‰ê· :</strong> ì•½ 2,000ë§Œì› (í•œêµ­ì¡°ì„¸ì¬ì •ì—°êµ¬ì› 2022)</li>
                                                            <li>â€¢ <strong>ë¶€ëª¨ 1ì¸ë‹¹:</strong> í‰ê·  1,000ë§Œì› ë‚´ì™¸</li>
                                                            <li>â€¢ <strong>ì‹œê¸°:</strong> ëŒ€ë¶€ë¶„ 50-70ëŒ€ì— ë°›ìŒ</li>
                                                            <li>â€¢ <strong>í˜•íƒœ:</strong> í˜„ê¸ˆ, ë¶€ë™ì‚°, ì£¼ì‹ ë“± ë‹¤ì–‘</li>
                                                        </ul>
                                                        <p className="text-xs mt-2 text-yellow-700">
                                                            * ê°€ì¡± ìƒí™©ì— ë”°ë¼ í° ì°¨ì´ê°€ ìˆìœ¼ë‹ˆ ì˜ˆìƒ ê°€ëŠ¥í•œ ê¸ˆì•¡ë§Œ ì…ë ¥í•˜ì„¸ìš”
                                                        </p>
                                                    </div>
                                                </div>
                                            )}
                                        </div>

                                        <div className="flex gap-4 mt-8">
                                            <button
                                                onClick={() => setCalculatorStep(1)}
                                                className="bg-gray-500 text-white px-6 py-3 rounded-lg font-semibold"
                                            >
                                                â† ì´ì „ ë‹¨ê³„
                                            </button>
                                            <button
                                                onClick={() => setCalculatorStep(3)}
                                                className="btn-primary flex-1"
                                                disabled={!formData.housingType}
                                            >
                                                ë‹¤ìŒ ë‹¨ê³„ â†’
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    );
                }

                if (calculatorStep === 3) {
                    return (
                        <div className="min-h-screen py-8 px-4">
                            <div className="max-w-2xl mx-auto">
                                <div className="text-center mb-8">
                                    <h1 className="text-3xl font-bold text-gray-800 mb-3">ğŸ“‹ ì¶”ê°€ ìˆ˜ì…Â·ì§€ì¶œ</h1>
                                    <p className="text-xl text-gray-600">ë§¤ë‹¬ ë“¤ì–´ì˜¤ëŠ” ì—°ê¸ˆì´ë‚˜ ë‚˜ê°€ëŠ” ê³ ì •ë¹„ìš© (ì„ íƒì‚¬í•­)</p>
                                    <div className="w-full bg-gray-200 rounded-full h-4 mt-6 max-w-md mx-auto">
                                        <div className="bg-blue-600 h-4 rounded-full" style={{width: '100%'}}></div>
                                    </div>
                                    <p className="text-lg text-gray-500 mt-3">3ë‹¨ê³„ / 3ë‹¨ê³„</p>
                                </div>

                                <div className="card">
                                    <div className="bg-green-50 border-l-4 border-green-400 p-6 mb-8 rounded-r-lg">
                                        <p className="text-lg text-green-800">
                                            ğŸ˜Š <strong>ì •í™•í•œ ìˆ˜ì¹˜ë¥¼ ëª¨ë¥´ì‹œëŠ” ê²½ìš°ì—ëŠ”</strong><br/>
                                            ì•Œê³  ê³„ì‹  ëŒ€ëµì ì¸ ê¸ˆì•¡ì„ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤.
                                        </p>
                                    </div>

                                    <h2 className="text-2xl font-bold mb-6 text-gray-800">ğŸ“ˆ ë§¤ë‹¬ ë°›ëŠ” ì—°ê¸ˆ (ë‹¨ìœ„: ë§Œì›)</h2>
                                    
                                    <AmountInput
                                        label="ğŸ›ï¸ êµ­ë¯¼ì—°ê¸ˆ (ì›” ìˆ˜ë ¹ì•¡)"
                                        value={formData.nationalPension}
                                        onChange={(v) => handleInputChange('nationalPension', v)}
                                        placeholder=""
                                        averageAmount={averageData?.nationalPension || 0}
                                    />
                                    
                                    <AmountInput
                                        label="ğŸ’° ê°œì¸ì—°ê¸ˆ (ì›” ìˆ˜ë ¹ì•¡)"
                                        value={formData.privatePension}
                                        onChange={(v) => handleInputChange('privatePension', v)}
                                        placeholder=""
                                        averageAmount={averageData?.privatePension || 0}
                                    />
                                    
                                    <AmountInput
                                        label="ğŸ  ì£¼íƒì—°ê¸ˆ (ì›” ìˆ˜ë ¹ì•¡)"
                                        value={formData.housingPension}
                                        onChange={(v) => handleInputChange('housingPension', v)}
                                        placeholder=""
                                        averageAmount={0}
                                    />

                                    <h2 className="text-2xl font-bold mb-6 mt-8 text-gray-800">ğŸ’¼ ê¸°íƒ€ ì›” ìˆ˜ì… (ë‹¨ìœ„: ë§Œì›)</h2>
                                    
                                    <AmountInput
                                        label="ğŸ  ì„ëŒ€ì†Œë“ (ì›” ìˆ˜ë ¹ì•¡)"
                                        value={formData.rentalIncome}
                                        onChange={(v) => handleInputChange('rentalIncome', v)}
                                        placeholder=""
                                        averageAmount={0}
                                    />
                                    
                                    <AmountInput
                                        label="ğŸ’¼ ê·¼ë¡œì†Œë“ (íŒŒíŠ¸íƒ€ì„, ìë¬¸ë£Œ ë“±)"
                                        value={formData.workIncome}
                                        onChange={(v) => handleInputChange('workIncome', v)}
                                        placeholder=""
                                        averageAmount={0}
                                    />
                                    
                                    <AmountInput
                                        label="ğŸ’° ê¸ˆìœµì†Œë“ (ë°°ë‹¹ê¸ˆ, ì´ì ë“±)"
                                        value={formData.financialIncome}
                                        onChange={(v) => handleInputChange('financialIncome', v)}
                                        placeholder=""
                                        averageAmount={0}
                                    />
                                    
                                    <AmountInput
                                        label="ğŸ“š ê¸°íƒ€ì†Œë“ (ê°•ì˜, ë¡œì—´í‹° ë“±)"
                                        value={formData.otherIncome}
                                        onChange={(v) => handleInputChange('otherIncome', v)}
                                        placeholder=""
                                        averageAmount={0}
                                    />


                                    <div className="flex gap-4 mt-8">
                                        <button
                                            onClick={() => setCalculatorStep(2)}
                                            className="bg-gray-500 text-white px-6 py-3 rounded-lg font-semibold"
                                        >
                                            â† ì´ì „ ë‹¨ê³„
                                        </button>
                                        <button
                                            onClick={calculateResults}
                                            className="btn-primary flex-1"
                                        >
                                            ğŸš€ ë…¸í›„ìƒí™œë¹„ ê³„ì‚°í•˜ê¸°
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    );
                }

                if (calculatorStep === 4 && calculatorResult) {
                    return (
                        <div className="min-h-screen py-8 px-4">
                            <div className="max-w-2xl mx-auto">
                                <div className="text-center mb-8">
                                    <h1 className="text-3xl font-bold text-gray-800 mb-3">ğŸ‰ ë…¸í›„ìƒí™œë¹„ ê³„ì‚° ì™„ë£Œ!</h1>
                                </div>

                                <div className="card mb-6">
                                    <div className="text-center">
                                        <div className="text-5xl font-bold text-blue-600 mb-4">
                                            í•˜ë£¨ {formatResultAmount(calculatorResult.totalDailyAvailable)}
                                        </div>
                                        <div className="text-3xl text-gray-600 mb-4">
                                            ì›” {formatResultAmount(calculatorResult.totalMonthlyAvailable)}
                                        </div>
                                        
                                        {/* ì•ˆì „ ìˆ˜ì¤€ í‘œì‹œ */}
                                        <div className={`inline-block px-6 py-3 rounded-full text-white font-bold text-lg mb-4 ${
                                            calculatorResult.safetyLevel === 'ì•ˆì „' ? 'bg-green-500' :
                                            calculatorResult.safetyLevel === 'ë³´í†µ' ? 'bg-yellow-500' : 'bg-red-500'
                                        }`}>
                                            {calculatorResult.safetyLevel} ìˆ˜ì¤€
                                        </div>
                                        
                                        {/* ê¸°ëŒ€ìˆ˜ëª… ì¡°ì • */}
                                        <div className="bg-blue-50 p-4 rounded-lg mb-4 max-w-md mx-auto">
                                            <div className="flex items-center justify-center gap-3 mb-2">
                                                <span className="text-sm font-medium text-blue-800">ê¸°ëŒ€ìˆ˜ëª…:</span>
                                                <div className="flex items-center gap-2">
                                                    <button 
                                                        onClick={() => setLifeExpectancy(Math.max(70, lifeExpectancy - 5))}
                                                        className="w-8 h-8 bg-blue-200 hover:bg-blue-300 rounded-full flex items-center justify-center text-blue-700 font-bold"
                                                    >
                                                        -
                                                    </button>
                                                    <span className="font-bold text-lg text-blue-600 min-w-[50px] text-center">{lifeExpectancy}ì„¸</span>
                                                    <button 
                                                        onClick={() => setLifeExpectancy(Math.min(110, lifeExpectancy + 5))}
                                                        className="w-8 h-8 bg-blue-200 hover:bg-blue-300 rounded-full flex items-center justify-center text-blue-700 font-bold"
                                                    >
                                                        +
                                                    </button>
                                                </div>
                                            </div>
                                            <div className="text-xs text-blue-600 text-center">
                                                {formData.age}ì„¸ë¶€í„° {lifeExpectancy}ì„¸ê¹Œì§€ ({lifeExpectancy - parseInt(formData.age)}ë…„ê°„) ìì‚° ë³´ì¡´
                                            </div>
                                        </div>

                                        
                                        {/* ê³„ì‚° ê²°ê³¼ ì €ì¥ */}
                                        {!isResultSaved ? (
                                            <div className="text-center mb-6">
                                                <button
                                                    onClick={saveCalculationResult}
                                                    className="px-8 py-4 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg font-bold text-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300"
                                                >
                                                    ğŸ’¾ ë‚´ ê³„ì‚°ê²°ê³¼ ì €ì¥í•˜ê¸°
                                                </button>
                                                <div className="text-sm text-blue-600 mt-2 font-medium">
                                                    ê³„ì‚° ê²°ê³¼ë¥¼ ì €ì¥í•˜ë©´ ë‚˜ì™€ ë¹„ìŠ·í•œ ì‚¬ëŒë“¤ê³¼ ì´ì•¼ê¸°í•  ìˆ˜ ìˆì–´ìš”!
                                                </div>
                                                <div className="text-sm text-gray-500 mt-1">
                                                    ì–¸ì œë“ ì§€ ë‹¤ì‹œ ê³„ì‚°í•˜ê³  ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                                                </div>
                                            </div>
                                        ) : (
                                            <div className="text-center mb-6">
                                                <div className="inline-block px-6 py-3 bg-green-100 text-green-800 rounded-lg font-semibold">
                                                    âœ… ê³„ì‚°ê²°ê³¼ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!
                                                </div>
                                                <div className="text-sm text-gray-500 mt-2">
                                                    ì–¸ì œë“ ì§€ ë‹¤ì‹œ ê³„ì‚°í•˜ê³  ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                                                </div>
                                                <div className="text-sm text-blue-600 mt-1 font-medium">
                                                    ğŸ‘‡ ì•„ë˜ì—ì„œ ë¹„ìŠ·í•œ ë¶„ë“¤ê³¼ ì†Œí†µí•´ë³´ì„¸ìš”
                                                </div>
                                            </div>
                                        )}
                                        
                                    </div>
                                </div>


                                <div className="card mb-6">
                                    <h3 className="text-xl font-bold mb-4">ğŸ’° ìˆ˜ì… êµ¬ì„±</h3>
                                    <div className="space-y-3">
                                        <div className="flex justify-between items-center">
                                            <span>ìì‚°ì„ í™œìš©í•œ ìƒí™œë¹„:</span>
                                            <div className="flex items-center gap-2">
                                                <span className="font-bold">{formatResultAmount(calculatorResult.monthlyAmount)}/ì›”</span>
                                                <button
                                                    onClick={() => setShowAssetDetail(!showAssetDetail)}
                                                    className="text-white text-sm px-3 py-2 bg-blue-500 rounded-lg hover:bg-blue-600 transition-colors font-semibold shadow-md animate-pulse"
                                                >
                                                    {showAssetDetail ? 'ğŸ“Š ê³„ì‚°ê³¼ì • ìˆ¨ê¸°ê¸°' : 'ğŸ“Š ê³„ì‚°ê³¼ì • ë³´ê¸°'}
                                                </button>
                                            </div>
                                        </div>
                                        
                                        {!showAssetDetail && (
                                            <div className="text-center mt-2">
                                                <p className="text-xs text-blue-600">ğŸ’¡ ê³„ì‚°ê³¼ì •ì„ ë³´ì‹œë©´ ìì‚° ë¶„ë¥˜ì™€ ì£¼íƒ ë§¤ê° ì˜µì…˜ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                                            </div>
                                        )}

                                        {/* ìì‚° ê³„ì‚° ìƒì„¸ ì„¤ëª… */}
                                        {showAssetDetail && (
                                            <div className="bg-blue-50 p-4 rounded-lg mt-3 space-y-3 text-sm">
                                                <div className="font-semibold text-blue-800 mb-2">ğŸ“Š ê³„ì‚° ê³¼ì •</div>
                                                
                                                <div className="space-y-3">
                                                    <div className="bg-white p-3 rounded-lg">
                                                        <div className="flex justify-between items-center mb-3">
                                                            <span className="font-medium">â€¢ ìˆœ ìì‚°:</span>
                                                            <span className="font-bold">{formatResultAmount(calculatorResult.assetBreakdown?.totalAssets || 0)}</span>
                                                        </div>
                                                        <p className="text-xs text-gray-600 mb-3">ì…ë ¥í•˜ì‹  ëª¨ë“  ìì‚°ì„ ìƒí™œë¹„ë¡œ ì“¸ ìˆ˜ ìˆëŠ” ìì‚°ê³¼ ì“¸ ìˆ˜ ì—†ëŠ” ìì‚°ìœ¼ë¡œ êµ¬ë¶„í–ˆìŠµë‹ˆë‹¤</p>
                                                        
                                                        {/* ìì‚° êµ¬ë¶„ í…Œì´ë¸” */}
                                                        <div className="grid grid-cols-2 gap-3 text-xs">
                                                            {/* ëˆì´ ë‚˜ì˜¤ëŠ” ìì‚° */}
                                                            <div className="bg-green-50 p-2 rounded border border-green-200">
                                                                <div className="font-semibold text-green-800 mb-2">ğŸ’° ìƒí™œë¹„ë¡œ ì“¸ ìˆ˜ ìˆëŠ” ìì‚°</div>
                                                                <div className="space-y-1 text-green-700">
                                                                    {parseInt(formData.financialAssets) > 0 && <div>â€¢ í˜„ê¸ˆì„± ìì‚°: {formatResultAmount(parseInt(formData.financialAssets) * 10000)}</div>}
                                                                    {parseInt(formData.severancePay) > 0 && <div>â€¢ í‡´ì§ê¸ˆ: {formatResultAmount(parseInt(formData.severancePay) * 10000)}</div>}
                                                                    {formData.homeValue && parseInt(formData.homeValue) > 0 && enableDownsizing && (
                                                                        <div>â€¢ ì£¼íƒ (ë§¤ê°): {formatResultAmount(calculatorResult.assetBreakdown?.realizedHousingAsset || 0)}</div>
                                                                    )}
                                                                    {parseInt(formData.housingPension) > 0 && (
                                                                        <div>â€¢ ì£¼íƒ (ì£¼íƒì—°ê¸ˆ): {formatResultAmount(parseInt(formData.homeValue) * 10000)}</div>
                                                                    )}
                                                                    {formData.jeonseDeposit && parseInt(formData.jeonseDeposit) > 0 && <div>â€¢ ì „ì„¸ë³´ì¦ê¸ˆ: {formatResultAmount(parseInt(formData.jeonseDeposit) * 10000)}</div>}
                                                                    {formData.monthlyDeposit && parseInt(formData.monthlyDeposit) > 0 && <div>â€¢ ì›”ì„¸ë³´ì¦ê¸ˆ: {formatResultAmount(parseInt(formData.monthlyDeposit) * 10000)}</div>}
                                                                </div>
                                                            </div>
                                                            
                                                            {/* ëˆì´ ë‚˜ì˜¤ì§€ ì•ŠëŠ” ìì‚° */}
                                                            <div className="bg-gray-50 p-2 rounded border border-gray-200">
                                                                <div className="font-semibold text-gray-800 mb-2">ğŸ  ìƒí™œë¹„ë¡œ ì“¸ ìˆ˜ ì—†ëŠ” ìì‚°</div>
                                                                <div className="space-y-1 text-gray-600">
                                                                    {formData.homeValue && parseInt(formData.homeValue) > 0 && !enableDownsizing && !parseInt(formData.housingPension) && (
                                                                        <div>â€¢ {formData.housingType === 'owned_living' ? 'ê±°ì£¼ìš©' : 'ì„ëŒ€ìš©'} ì£¼íƒ: {formatResultAmount(parseInt(formData.homeValue) * 10000)}</div>
                                                                    )}
                                                                    {formData.investmentRealEstate && parseInt(formData.investmentRealEstate) > 0 && (
                                                                        <div>â€¢ ìˆ˜ìµí˜• ë¶€ë™ì‚°: {formatResultAmount(parseInt(formData.investmentRealEstate) * 10000)}</div>
                                                                    )}
                                                                    {formData.currentDeposit && parseInt(formData.currentDeposit) > 0 && <div>â€¢ ê±°ì£¼ì§€ ë³´ì¦ê¸ˆ: {formatResultAmount(parseInt(formData.currentDeposit) * 10000)}</div>}
                                                                    {formData.inheritance && parseInt(formData.inheritance) > 0 && <div>â€¢ ì¦ì—¬/ìƒì† ì˜ˆì •: {formatResultAmount(parseInt(formData.inheritance) * 10000)}</div>}
                                                                    {(!formData.homeValue || parseInt(formData.homeValue) === 0 || 
                                                                      (formData.housingType === 'owned_living' && (enableDownsizing || parseInt(formData.housingPension))) ||
                                                                      (formData.housingType === 'owned_renting' && enableDownsizing)) && 
                                                                     (!formData.inheritance || parseInt(formData.inheritance) === 0) &&
                                                                     (!formData.currentDeposit || parseInt(formData.currentDeposit) === 0) && (
                                                                        <div className="text-gray-400 italic">í•´ë‹¹ ì—†ìŒ</div>
                                                                    )}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        {/* ë¶€ì±„ ì°¨ê° */}
                                                        {((formData.debt && parseInt(formData.debt) > 0) || (formData.homeMortgage && parseInt(formData.homeMortgage) > 0) || (formData.investmentLoan && parseInt(formData.investmentLoan) > 0) || (formData.depositLoan && parseInt(formData.depositLoan) > 0) || (formData.ownedHouseDeposit && parseInt(formData.ownedHouseDeposit) > 0)) && (
                                                            <div className="mt-3 p-2 bg-red-50 rounded border border-red-200">
                                                                <div className="font-semibold text-red-800 mb-1 text-xs">ğŸ’³ ë¶€ì±„ ì°¨ê°</div>
                                                                <div className="space-y-1 text-xs text-red-700">
                                                                    {formData.debt && parseInt(formData.debt) > 0 && <div>â€¢ ê¸°íƒ€ ëŒ€ì¶œ: -{formatResultAmount(parseInt(formData.debt) * 10000)}</div>}
                                                                    {formData.homeMortgage && parseInt(formData.homeMortgage) > 0 && <div>â€¢ ì£¼íƒëŒ€ì¶œ: -{formatResultAmount(parseInt(formData.homeMortgage) * 10000)}</div>}
                                                                    {formData.investmentLoan && parseInt(formData.investmentLoan) > 0 && <div>â€¢ íˆ¬ìëŒ€ì¶œ: -{formatResultAmount(parseInt(formData.investmentLoan) * 10000)}</div>}
                                                                    {formData.depositLoan && parseInt(formData.depositLoan) > 0 && <div>â€¢ ë³´ì¦ê¸ˆ ëŒ€ì¶œ: -{formatResultAmount(parseInt(formData.depositLoan) * 10000)}</div>}
                                                                    {formData.ownedHouseDeposit && parseInt(formData.ownedHouseDeposit) > 0 && <div>â€¢ ì„ì°¨ì¸ ë³´ì¦ê¸ˆ: -{formatResultAmount(parseInt(formData.ownedHouseDeposit) * 10000)}</div>}
                                                                </div>
                                                            </div>
                                                        )}
                                                    </div>

                                                    {/* ì£¼íƒ ë§¤ê° ì˜µì…˜ */}
                                                    {(formData.housingType === 'owned_living' || formData.housingType === 'owned_renting') && !parseInt(formData.housingPension) && (
                                                        <div className="bg-orange-50 p-3 rounded-lg border-l-4 border-orange-300 mt-3">
                                                            <div className="flex items-center justify-between mb-2">
                                                                <span className="text-sm font-medium text-orange-800">ğŸ  ì£¼íƒ ë§¤ê° ì˜µì…˜</span>
                                                                <label className="flex items-center gap-2 cursor-pointer">
                                                                    <input 
                                                                        type="checkbox" 
                                                                        checked={enableDownsizing}
                                                                        onChange={(e) => setEnableDownsizing(e.target.checked)}
                                                                        className="w-4 h-4 text-orange-600 rounded focus:ring-orange-500"
                                                                    />
                                                                    <span className="text-sm font-medium text-orange-800">ë§¤ê°í–ˆì„ ë•Œ ìƒí™œë¹„ ê³„ì‚°í•˜ê¸°</span>
                                                                </label>
                                                            </div>
                                                            <div className="text-xs text-orange-600">
                                                                ì£¼íƒì„ ë§¤ê°í•˜ë©´ ë” ë§ì€ ë…¸í›„ìƒí™œë¹„ë¥¼ í™•ë³´í•  ìˆ˜ ìˆì–´ìš”.
                                                            </div>
                                                        </div>
                                                    )}

                                                    {/* ì£¼íƒ ë§¤ê° ì˜µì…˜ í‘œì‹œ */}
                                                    {calculatorResult.assetBreakdown?.enableDownsizing && (calculatorResult.assetBreakdown?.housingType === 'owned_living' || calculatorResult.assetBreakdown?.housingType === 'owned_renting') && (
                                                        <div className="bg-orange-50 p-3 rounded-lg border-l-4 border-orange-300">
                                                            <div className="flex items-center gap-2 mb-1">
                                                                <span className="text-orange-600">ğŸ </span>
                                                                <span className="font-medium text-orange-800">ì£¼íƒ ë§¤ê° ì˜µì…˜ ì ìš©</span>
                                                            </div>
                                                            <p className="text-xs text-orange-700">
                                                                ì£¼íƒì„ ë§¤ê°í•˜ì—¬ í˜„ê¸ˆí™”í•©ë‹ˆë‹¤ (ë³´ìˆ˜ì  ê³„ì‚°ì„ ìœ„í•´ ì–‘ë„ì„¸+ìˆ˜ìˆ˜ë£Œ 25% ì°¨ê° í›„ 
                                                                {calculatorResult.assetBreakdown?.housingType === 'owned_living' ? 
                                                                    `, ì£¼íƒë‹´ë³´ëŒ€ì¶œ ${formatResultAmount(calculatorResult.assetBreakdown?.housingDebt || 0)} ì¶”ê°€ ì°¨ê°í•˜ì—¬` :
                                                                    `, ì„ì°¨ì¸ ë³´ì¦ê¸ˆ ${formatResultAmount(calculatorResult.assetBreakdown?.ownedHouseDepositDebt || 0)}, ì£¼íƒë‹´ë³´ëŒ€ì¶œ ${formatResultAmount(calculatorResult.assetBreakdown?.housingDebt || 0)} ì¶”ê°€ ì°¨ê°í•˜ì—¬`
                                                                } {formatResultAmount(calculatorResult.assetBreakdown?.realizedHousingAsset || 0)} í™œìš©)
                                                            </p>
                                                        </div>
                                                    )}

                                                    <div className="bg-white p-3 rounded-lg">
                                                        <div className="flex justify-between items-center mb-1">
                                                            <span className="font-medium">â€¢ ë¹„ìƒìê¸ˆ ì œì™¸:</span>
                                                            <span className="font-bold text-red-600">-{formatResultAmount(calculatorResult.assetBreakdown?.emergencyFund || 0)}</span>
                                                        </div>
                                                        <p className="text-xs text-gray-600">ì˜ˆìƒì¹˜ ëª»í•œ ì˜ë£Œë¹„ ë“±ì„ ìœ„í•´ í˜„ê¸ˆì„± ìì‚°ì˜ 10%ë¥¼ ë¹„ìƒìê¸ˆìœ¼ë¡œ ë³´ì¡´í•©ë‹ˆë‹¤</p>
                                                    </div>

                                                    <div className="bg-white p-3 rounded-lg">
                                                        <div className="flex justify-between items-center mb-1">
                                                            <span className="font-medium">â€¢ ìƒí™œë¹„ë¡œ ì“¸ ìˆ˜ ìˆëŠ” ìì‚°:</span>
                                                            <span className="font-bold text-green-600">{formatResultAmount(calculatorResult.assetBreakdown?.availableAssets || 0)}</span>
                                                        </div>
                                                        <p className="text-xs text-gray-600">ë¹„ìƒìê¸ˆê¹Œì§€ ì°¨ê°í•˜ê³  ê¸°ëŒ€ìˆ˜ëª…ê¹Œì§€ ì†Œë¹„í•  ìˆ˜ ìˆëŠ” ìì‚°ì…ë‹ˆë‹¤</p>
                                                    </div>

                                                    <div className="bg-white p-3 rounded-lg">
                                                        <div className="flex justify-between items-center mb-1">
                                                            <span className="font-medium">â€¢ ì†Œë¹„ ì˜ˆìƒ ê¸°ê°„:</span>
                                                            <span className="font-bold text-blue-600">{calculatorResult.yearsToLive || 0}ë…„</span>
                                                        </div>
                                                        <p className="text-xs text-gray-600">í˜„ì¬ ë‚˜ì´ë¶€í„° ê¸°ëŒ€ìˆ˜ëª…ê¹Œì§€ ìì‚°ì„ ì†Œë¹„í•˜ëŠ” ê¸°ê°„ì…ë‹ˆë‹¤</p>
                                                    </div>

                                                    <div className="bg-blue-100 p-3 rounded-lg border-t-2 border-blue-300">
                                                        <div className="text-center font-bold text-green-600 text-lg">
                                                            ì†Œë¹„ ê°€ëŠ¥í•œ ìì‚°ì€ ì—°ê°„ {formatResultAmount(calculatorResult.monthlyAmount * 12)}, ì›”ê°„ {formatResultAmount(calculatorResult.monthlyAmount)} ì…ë‹ˆë‹¤.
                                                        </div>
                                                    </div>
                                                </div>

                                                <div className="text-xs text-blue-700 mt-3 p-3 bg-blue-100 rounded border-l-4 border-blue-400">
                                                    ğŸ’¡ <strong>ê³„ì‚° ê³µì‹:</strong> ìƒí™œë¹„ë¡œ ì“¸ ìˆ˜ ìˆëŠ” ìì‚° Ã· ì†Œë¹„ì˜ˆìƒê¸°ê°„ Ã· 12ê°œì›” = ì›” ì‚¬ìš© ê°€ëŠ¥ ê¸ˆì•¡<br/>
                                                    <div className="mt-2 p-2 bg-yellow-50 rounded border border-yellow-200">
                                                        <strong>âš ï¸ ì¤‘ìš”:</strong> ì´ ê³„ì‚°ì€ <strong>{lifeExpectancy}ì„¸ê¹Œì§€</strong> ìì‚°ì„ ì†Œë¹„í•œë‹¤ê³  ê°€ì •í•˜ê³  ê³„ì‚°ë˜ì—ˆìŠµë‹ˆë‹¤.(íˆ¬ììˆ˜ìµë¥ ì„ ë°°ì œ)
                                                    </div>
                                                </div>
                                            </div>
                                        )}

                                        {calculatorResult.monthlyPension > 0 && (
                                            <div className="flex justify-between text-green-700">
                                                <span>+ ì—°ê¸ˆ ìˆ˜ì…:</span>
                                                <span className="font-bold">+{formatResultAmount(calculatorResult.monthlyPension)}/ì›”</span>
                                            </div>
                                        )}
                                        {calculatorResult.monthlyOtherIncome > 0 && (
                                            <div className="flex justify-between text-green-700">
                                                <span>+ ê¸°íƒ€ ì›” ìˆ˜ì…:</span>
                                                <span className="font-bold">+{formatResultAmount(calculatorResult.monthlyOtherIncome)}/ì›”</span>
                                            </div>
                                        )}
                                        {calculatorResult.monthlyHousingCost > 0 && (
                                            <div className="flex justify-between text-red-700">
                                                <span>- ì›”ì„¸ ì§€ì¶œ:</span>
                                                <span className="font-bold">-{formatResultAmount(calculatorResult.monthlyHousingCost)}/ì›”</span>
                                            </div>
                                        )}
                                        {calculatorResult.monthlyLoanInterest > 0 && (
                                            <div className="flex justify-between text-red-700">
                                                <span>- ì›” ëŒ€ì¶œ ì´ì:</span>
                                                <span className="font-bold">-{formatResultAmount(calculatorResult.monthlyLoanInterest)}/ì›”</span>
                                            </div>
                                        )}
                                        <div className="flex justify-between font-bold pt-2 border-t border-blue-200 text-lg">
                                            <span>ì›”ê°„ ì´ ë…¸í›„ìƒí™œë¹„:</span>
                                            <span className="text-blue-600">{formatResultAmount(calculatorResult.totalMonthlyAvailable)}/ì›”</span>
                                        </div>
                                    </div>
                                </div>

                                {/* ì»¤ë®¤ë‹ˆí‹° ì„¹ì…˜ - ì €ì¥ í›„ì—ë§Œ í‘œì‹œ */}
                                {isResultSaved && (
                                    <div className="card mb-6">
                                        <h3 className="text-xl font-bold mb-4">ğŸ‘¥ ë‚˜ì™€ ë¹„ìŠ·í•œ ì‚¬ëŒë“¤ê³¼ ì†Œí†µí•´ë³´ì„¸ìš”</h3>
                                    
                                    {/* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */}
                                    <div className="flex gap-2 mb-6">
                                        <button
                                            className={`flex-1 py-3 px-4 rounded-lg font-semibold transition-all duration-300 ${
                                                activeTab === 'expense' 
                                                    ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg' 
                                                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                                            }`}
                                            onClick={() => setActiveTab('expense')}
                                        >
                                            ğŸ“Š ì§€ì¶œë‚´ì—­ ê³µìœ 
                                        </button>
                                        <button
                                            className={`flex-1 py-3 px-4 rounded-lg font-semibold transition-all duration-300 ${
                                                activeTab === 'community' 
                                                    ? 'bg-gradient-to-r from-green-500 to-blue-500 text-white shadow-lg' 
                                                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 animate-pulse'
                                            }`}
                                            onClick={() => setActiveTab('community')}
                                        >
                                            ğŸ’¬ ì»¤ë®¤ë‹ˆí‹° ì°¸ì—¬
                                        </button>
                                    </div>

                                    {/* ì§€ì¶œë‚´ì—­ ê³µìœ  íƒ­ */}
                                    {activeTab === 'expense' && (
                                        <div className="bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg">
                                            <div className="bg-white p-4 rounded-lg mb-4">
                                                <p className="text-gray-800 font-semibold">
                                                    ğŸ’° <strong>ì§€ì¶œë‚´ì—­ ì…ë ¥</strong> í›„<br/>
                                                    ë¹„ìŠ·í•œ ì‚¬ëŒë“¤ì´ ì–´ë–»ê²Œ ëˆì„ ì“°ê³  ìˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                                                </p>
                                            </div>
                                            
                                            <div className="grid grid-cols-2 gap-2 mb-4 text-xs">
                                                <div className="bg-white p-2 rounded-lg text-center">
                                                    <div className="font-bold text-purple-600">"ì‹ë¹„ëŠ” ì–¼ë§ˆê°€ ì ë‹¹í• ê¹Œìš”?"</div>
                                                </div>
                                                <div className="bg-white p-2 rounded-lg text-center">
                                                    <div className="font-bold text-purple-600">"ë‹¤ë¥¸ì‚¬ëŒì€ ì˜ë£Œë¹„ë¥¼ ì–¼ë§ˆë‚˜ ì“¸ê¹Œìš”?"</div>
                                                </div>
                                                <div className="bg-white p-2 rounded-lg text-center">
                                                    <div className="font-bold text-purple-600">"ì·¨ë¯¸Â·ì—¬ê°€ë¹„ í˜„ì‹¤ì ì¸ ê¸°ì¤€ì€?"</div>
                                                </div>
                                                <div className="bg-white p-2 rounded-lg text-center">
                                                    <div className="font-bold text-purple-600">"ìƒí™œë¹„ëŠ” ì–¼ë§ˆê°€ ì ì •í• ê¹Œìš”?"</div>
                                                </div>
                                            </div>
                                            
                                            <div className="bg-purple-100 p-3 rounded-lg mb-4 text-center">
                                                <p className="text-purple-800 font-semibold">
                                                    ğŸ“ˆ <strong>ë” ë‚˜ì€ ì„œë¹„ìŠ¤ ì œê³µì„ ìœ„í•´ì„œë§Œ ìµëª…ìœ¼ë¡œ í™œìš©ë©ë‹ˆë‹¤</strong>
                                                </p>
                                                <p className="text-purple-700 text-sm">ë‚´ ë˜ë˜ì˜ ì‹¤ì œ ì§€ì¶œ íŒ¨í„´ì„ í™•ì¸í•˜ì„¸ìš”</p>
                                            </div>
                                            
                                            <button
                                                onClick={openExpenseModal}
                                                className="w-full text-lg py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg font-semibold transform hover:scale-105 transition-all duration-300"
                                            >
                                                ğŸ“ ì§€ì¶œë‚´ì—­ ì…ë ¥í•˜ê¸°
                                            </button>
                                        </div>
                                    )}

                                    {/* ì»¤ë®¤ë‹ˆí‹° ì°¸ì—¬ íƒ­ */}
                                    {activeTab === 'community' && (
                                        <div className="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg">
                                            <div className="bg-white p-4 rounded-lg mb-4">
                                                <p className="text-gray-800 font-semibold">
                                                    ğŸ¤ <strong>ìµëª… ë¼ì´í”„ìŠ¤íƒ€ì¼ ì»¤ë®¤ë‹ˆí‹°</strong>ì—ì„œ<br/>
                                                    ë¹„ìŠ·í•œ ìì‚°ê³¼ ë‚˜ì´ëŒ€({formData.age}ì„¸)ì˜ ì‚¬ëŒë“¤ê³¼ ì†”ì§í•œ ê²½í—˜ì„ ë‚˜ëˆ„ì–´ë³´ì„¸ìš”.
                                                </p>
                                            </div>
                                            
                                            <div className="grid grid-cols-2 gap-2 mb-4 text-xs">
                                                <div className="bg-white p-2 rounded-lg text-center">
                                                    <div className="font-bold text-blue-600">"ì‹¤ì œë¡œ ì´ ëˆìœ¼ë¡œ ì‚´ ìˆ˜ ìˆë‚˜ìš”?"</div>
                                                </div>
                                                <div className="bg-white p-2 rounded-lg text-center">
                                                    <div className="font-bold text-blue-600">"ì˜ˆìƒì¹˜ ëª»í•œ ë¹„ìš©ë“¤ì€ ë­ê°€ ìˆë‚˜ìš”?"</div>
                                                </div>
                                                <div className="bg-white p-2 rounded-lg text-center">
                                                    <div className="font-bold text-blue-600">"ì–´ë–¤ ì„œë¹„ìŠ¤ë“¤ì„ ì‹¤ì œë¡œ ì´ìš©í•˜ì‹œë‚˜ìš”?"</div>
                                                </div>
                                                <div className="bg-white p-2 rounded-lg text-center">
                                                    <div className="font-bold text-blue-600">"ë…¸í›„ ìƒí™œì˜ í˜„ì‹¤ì ì¸ íŒë“¤"</div>
                                                </div>
                                            </div>
                                            
                                            <div className="bg-green-100 p-3 rounded-lg mb-4 text-center">
                                                <p className="text-green-800 font-semibold">
                                                    âœ¨ <strong>ê¸ˆìœµìƒí’ˆ íŒë§¤ëŠ” ì¼ì²´ ì—†ìŠµë‹ˆë‹¤</strong> âœ¨
                                                </p>
                                                <p className="text-green-700 text-sm">ìˆœìˆ˜ ë¼ì´í”„ìŠ¤íƒ€ì¼ ì»¤ë®¤ë‹ˆí‹°ì…ë‹ˆë‹¤</p>
                                            </div>
                                            
                                            <div className="text-sm text-gray-500 mb-3 text-center">
                                                ğŸ’¡ ë§Œì› ë¯¸ë§Œì€ ì ˆì‚¬í•˜ì—¬ í‘œì‹œë©ë‹ˆë‹¤
                                            </div>
                                            
                                            <button
                                                onClick={joinCommunity}
                                                className="w-full text-lg py-3 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-lg font-semibold transform hover:scale-105 transition-all duration-300"
                                            >
                                                ğŸ¤ ìµëª… ì»¤ë®¤ë‹ˆí‹°<br/>ì°¸ì—¬í•˜ê¸°
                                            </button>
                                        </div>
                                    )}
                                    </div>
                                )}

                                <div className="text-center">
                                    <button
                                        onClick={() => setCalculatorStep(1)}
                                        className="text-gray-500 underline hover:text-gray-700"
                                    >
                                        ë‹¤ì‹œ ê³„ì‚°í•˜ê¸°
                                    </button>
                                </div>
                            </div>
                        </div>
                    );
                }
            };

            const renderCommunity = () => {
                if (communityTab === 'posts') {
                    return (
                        <div className="min-h-screen py-8 px-4">
                            <div className="max-w-4xl mx-auto">
                                <div className="text-center mb-8">
                                    <h1 className="text-3xl font-bold text-gray-800 mb-3">ğŸ’¬ ë…¸í›„ìƒí™œ ì´ëª¨ì €ëª¨</h1>
                                    <p className="text-xl text-gray-600">ìµëª…ìœ¼ë¡œ ì§„ì§œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ëŠ” ê³µê°„</p>
                                </div>

                                {/* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */}
                                <div className="flex gap-4 mb-6">
                                    <button 
                                        className={`tab-button ${communityTab === 'posts' ? 'active' : ''}`}
                                        onClick={() => setCommunityTab('posts')}
                                    >
                                        ğŸ“ ê²Œì‹œê¸€
                                    </button>
                                    <button 
                                        className={`tab-button ${communityTab === 'write' ? 'active' : ''}`}
                                        onClick={() => setCommunityTab('write')}
                                    >
                                        âœï¸ ê¸€ì“°ê¸°
                                    </button>
                                </div>

                                {/* ê²Œì‹œê¸€ ëª©ë¡ */}
                                <div className="space-y-4">
                                    {samplePosts.map(post => (
                                        <div key={post.id} className="community-post">
                                            <div className="flex items-center gap-2 mb-2">
                                                <span className="anonymous-badge">{post.author}</span>
                                                <span className="asset-badge">{post.authorProfile.assets}</span>
                                                <span className="region-badge">{post.authorProfile.region}</span>
                                                <span className="text-sm text-gray-500">{post.authorProfile.age}ì„¸</span>
                                                <span className="text-sm text-gray-500">â€¢ {post.timestamp}</span>
                                            </div>
                                            <h3 className="font-bold text-lg mb-2">{post.title}</h3>
                                            <p className="text-gray-700 mb-3">{post.content}</p>
                                            <div className="flex items-center gap-4 text-sm text-gray-500">
                                                <span>ğŸ‘ {post.likes}</span>
                                                <span>ğŸ’¬ {post.replies.length}</span>
                                                <button 
                                                    className="text-green-600 hover:underline"
                                                    onClick={() => setSelectedPost(selectedPost === post.id ? null : post.id)}
                                                >
                                                    {selectedPost === post.id ? 'ìˆ¨ê¸°ê¸°' : 'ëŒ“ê¸€ ë³´ê¸°'}
                                                </button>
                                            </div>

                                            {/* ëŒ“ê¸€ */}
                                            {selectedPost === post.id && post.replies.map((reply, idx) => (
                                                <div key={idx} className="reply">
                                                    <div className="flex items-center gap-2 mb-1">
                                                        <span className="anonymous-badge text-xs">{reply.author}</span>
                                                        <span className="asset-badge text-xs">{reply.authorProfile.assets}</span>
                                                        <span className="region-badge text-xs">{reply.authorProfile.region}</span>
                                                        <span className="text-xs text-gray-500">{reply.authorProfile.age}ì„¸</span>
                                                        <span className="text-xs text-gray-500">â€¢ {reply.timestamp}</span>
                                                    </div>
                                                    <p className="text-sm text-gray-700 mb-1">{reply.content}</p>
                                                    <span className="text-xs text-gray-500">ğŸ‘ {reply.likes}</span>
                                                </div>
                                            ))}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    );
                }

                if (communityTab === 'write') {
                    return (
                        <div className="min-h-screen py-8 px-4">
                            <div className="max-w-2xl mx-auto">
                                <div className="mb-4">
                                    <button
                                        onClick={() => setCommunityTab('posts')}
                                        className="flex items-center gap-2 text-gray-600 hover:text-blue-600 font-semibold"
                                    >
                                        â† ê²Œì‹œê¸€ë¡œ ëŒì•„ê°€ê¸°
                                    </button>
                                </div>
                                <div className="text-center mb-8">
                                    <h1 className="text-3xl font-bold text-gray-800 mb-3">âœï¸ ì†”ì§í•œ ì´ì•¼ê¸° ë‚˜ëˆ„ê¸°</h1>
                                    <p className="text-xl text-gray-600">ìµëª…ìœ¼ë¡œ ì§„ì§œ ê³ ë¯¼ì„ í„¸ì–´ë†“ìœ¼ì„¸ìš”</p>
                                </div>

                                <div className="card">
                                    <div className="space-y-4">
                                        <div>
                                            <label className="block font-semibold mb-2">ì œëª©</label>
                                            <input
                                                type="text"
                                                className="w-full p-3 border-2 border-gray-200 rounded-lg"
                                                placeholder="ì˜ˆ: 5ì–µ ìì‚°ìœ¼ë¡œ ì •ë§ ì•ˆì „í•œ ì€í‡´ê°€ ê°€ëŠ¥í• ê¹Œìš”?"
                                            />
                                        </div>
                                        <div>
                                            <label className="block font-semibold mb-2">ë‚´ìš©</label>
                                            <textarea
                                                className="w-full p-3 border-2 border-gray-200 rounded-lg"
                                                rows="8"
                                                placeholder="ì†”ì§í•œ ê³ ë¯¼ì´ë‚˜ ê²½í—˜ì„ ììœ ë¡­ê²Œ ì ì–´ì£¼ì„¸ìš”. êµ¬ì²´ì ì¸ ê¸ˆì•¡ì´ë‚˜ ìƒí™©ì„ ê³µìœ í• ìˆ˜ë¡ ë” ë„ì›€ì´ ë˜ëŠ” ë‹µë³€ì„ ë°›ì„ ìˆ˜ ìˆì–´ìš”."
                                            />
                                        </div>
                                        <div className="bg-blue-50 p-4 rounded-lg">
                                            <p className="text-blue-800 text-sm">
                                                ğŸ’¡ <strong>íŒ:</strong> "ì‹¤ì œë¡œ ì›” ì–¼ë§ˆë‚˜ ì“°ì‹œë‚˜ìš”?", "ì˜ˆìƒì¹˜ ëª»í•œ ë¹„ìš©ì´ ë­ê°€ ìˆë‚˜ìš”?" ê°™ì€ êµ¬ì²´ì ì¸ ì§ˆë¬¸ì¼ìˆ˜ë¡ ë§ì€ ë¶„ë“¤ì´ ë‹µë³€í•´ì£¼ì„¸ìš”.
                                            </p>
                                        </div>
                                        <button className="btn-primary w-full">
                                            ğŸ“ ìµëª…ìœ¼ë¡œ ê¸€ ì˜¬ë¦¬ê¸°
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    );
                }

                if (communityTab === 'myprofile') {
                    const profile = JSON.parse(localStorage.getItem('planb_profile') || '{}');
                    return (
                        <div className="min-h-screen py-8 px-4">
                            <div className="max-w-2xl mx-auto">
                                <div className="text-center mb-8">
                                    <h1 className="text-3xl font-bold text-gray-800 mb-3">ğŸ‘¤ ë‚´ ìµëª… í”„ë¡œí•„</h1>
                                    <p className="text-xl text-gray-600">ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì •ë³´ì…ë‹ˆë‹¤</p>
                                </div>

                                <div className="card">
                                    <div className="space-y-4">
                                        <div className="flex items-center gap-2">
                                            <span className="anonymous-badge">{profile.nickname || 'í”Œëœë¹„ì‚¬ìš©ì'}</span>
                                            <span className="text-gray-500">ê°€ì…ì¼: {profile.joinDate}</span>
                                        </div>
                                        <div className="grid grid-cols-2 gap-4">
                                            <div className="bg-gray-50 p-3 rounded-lg">
                                                <p className="text-sm text-gray-600">ë‚˜ì´</p>
                                                <p className="font-bold">{profile.age || '-'}ì„¸</p>
                                            </div>
                                            <div className="bg-gray-50 p-3 rounded-lg">
                                                <p className="text-sm text-gray-600">ìì‚°ê·œëª¨</p>
                                                <p className="font-bold">{profile.assets || '-'}</p>
                                            </div>
                                            <div className="bg-gray-50 p-3 rounded-lg">
                                                <p className="text-sm text-gray-600">ê±´ê°•ìƒíƒœ</p>
                                                <p className="font-bold">{profile.health || '-'}</p>
                                            </div>
                                            <div className="bg-gray-50 p-3 rounded-lg">
                                                <p className="text-sm text-gray-600">ìƒí™œëª¨ë“œ</p>
                                                <p className="font-bold">{profile.lifestyle || '-'}</p>
                                            </div>
                                            <div className="bg-gray-50 p-3 rounded-lg">
                                                <p className="text-sm text-gray-600">ì§€ì—­</p>
                                                <p className="font-bold">{profile.region || 'ì„œìš¸'}</p>
                                            </div>
                                            <div className="bg-gray-50 p-3 rounded-lg">
                                                <p className="text-sm text-gray-600">ì„±ë³„</p>
                                                <p className="font-bold">{profile.gender || 'ë‚¨ì„±'}</p>
                                            </div>
                                        </div>
                                        <div className="bg-blue-50 p-4 rounded-lg">
                                            <p className="text-blue-800">
                                                <strong>ğŸ’° ì›” ë…¸í›„ìƒí™œë¹„:</strong> {(profile.monthlyRetirementBudget || 0).toLocaleString()}ë§Œì›
                                            </p>
                                            {profile.monthlyRetirementBudget > 0 && (
                                                <p className="text-xs text-blue-600 mt-1">
                                                    ê³„ì‚°ê¸° ê²°ê³¼ ê¸°ì¤€ (ìì‚° + ì—°ê¸ˆ + ê¸°íƒ€ìˆ˜ì… - ê³ ì •ì§€ì¶œ)
                                                </p>
                                            )}
                                        </div>
                                        <div className="bg-green-50 p-4 rounded-lg">
                                            <p className="text-green-800 text-sm">
                                                ğŸ”’ <strong>ê°œì¸ì •ë³´ ë³´í˜¸:</strong> ëª¨ë“  ì •ë³´ëŠ” ìµëª…ìœ¼ë¡œ ì²˜ë¦¬ë˜ë©°, ê°œì¸ì„ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ì •ë³´ëŠ” ì €ì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    );
                }
            };

            const renderServices = () => {
                const tabs = ['ìƒí™œì¼€ì–´', 'ê±´ê°•ê´€ë¦¬', 'ì—¬í–‰', 'ì‹œë‹ˆì–´ ì¼ìë¦¬'];
                const currentServices = partnerServices[serviceTab];

                return (
                    <div className="min-h-screen py-8 px-4">
                        <div className="max-w-4xl mx-auto">
                            <div className="text-center mb-8">
                                <h1 className="text-3xl font-bold text-gray-800 mb-3">ğŸ›ï¸ ì‹œë‹ˆì–´ ë§ì¶¤ ì„œë¹„ìŠ¤</h1>
                                <p className="text-xl text-gray-600">í”Œëœë¹„ ì»¤ë®¤ë‹ˆí‹°ë¡œ ê²€ì¦í•˜ëŠ” ì‹œë‹ˆì–´ ë¼ì´í”„ì¼€ì–´</p>
                            </div>

                            <div className="bg-green-50 border-l-4 border-green-400 p-4 mb-8">
                                <p className="text-green-800">
                                    ğŸ“ <strong>í›„ê¸° ë‚¨ê¸°ê¸°:</strong> ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì‹  í›„ ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ì†”ì§í•œ í›„ê¸°ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”. 
                                    ë‹¤ë¥¸ ë¶„ë“¤ì—ê²Œ í° ë„ì›€ì´ ë©ë‹ˆë‹¤!
                                </p>
                            </div>

                            {/* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */}
                            <div className="flex gap-4 mb-8 overflow-x-auto">
                                {tabs.map(tab => (
                                    <button
                                        key={tab}
                                        className={`tab-button whitespace-nowrap ${serviceTab === tab ? 'active' : ''}`}
                                        onClick={() => setServiceTab(tab)}
                                    >
                                        {tab === 'ìƒí™œì¼€ì–´' && 'ğŸ '} {tab === 'ê±´ê°•ê´€ë¦¬' && 'ğŸ¥'} {tab === 'ì—¬í–‰' && 'âœˆï¸'} {tab === 'ì‹œë‹ˆì–´ ì¼ìë¦¬' && 'ğŸ’¼'} {tab}
                                    </button>
                                ))}
                            </div>

                            {/* í˜„ì¬ íƒ­ì˜ ì„œë¹„ìŠ¤ë“¤ */}
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                {currentServices.map((service, serviceIdx) => (
                                    <div key={serviceIdx} className="service-card">
                                        <div className="flex items-center gap-2 mb-2">
                                            <h3 className="font-bold text-lg">{service.name}</h3>
                                            <span className="dday-badge">D-{service.dday}</span>
                                        </div>
                                        <p className="text-gray-600 mb-2">{service.description}</p>
                                        <div className="flex items-center gap-2 mb-2">
                                            <span className="text-yellow-500">â­</span>
                                            <span className="font-semibold">{service.rating}</span>
                                            <span className="text-gray-500">({service.reviews}ê°œ í›„ê¸°)</span>
                                        </div>
                                        <div className="mb-2">
                                            <span className="font-bold text-blue-600">{service.price}</span>
                                        </div>
                                        {service.discount && (
                                            <div className="bg-red-50 text-red-700 p-2 rounded text-sm mb-3">
                                                ğŸ‰ {service.discount}
                                            </div>
                                        )}
                                        <div className="space-y-2">
                                            <div className="bg-blue-50 p-2 rounded text-xs">
                                                <strong>í¬í•¨ì‚¬í•­:</strong> {service.detailFeatures.join(', ')}
                                            </div>
                                            <div className="bg-gray-50 p-2 rounded text-xs">
                                                <strong>ì‹¤ì œ í›„ê¸°:</strong> "{service.realReviews[0]}", "{service.realReviews[1]}"
                                            </div>
                                            <div className="flex gap-2">
                                                <button className="btn-primary w-full text-sm py-2">
                                                    ìƒì„¸ë³´ê¸° ë° ì‹ ì²­
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>

                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */}
                    <nav className="bg-white shadow-sm border-b">
                        <div className="max-w-6xl mx-auto px-4">
                            <div className="flex justify-between items-center h-16">
                                <div className="font-bold text-xl text-blue-600">í–‰ë³µí•œ ë…¸í›„ìƒí™œì˜ ì‹œì‘, í”Œëœë¹„</div>
                                <div className="flex gap-6">
                                    <button 
                                        className={`px-4 py-2 rounded-lg font-semibold ${currentView === 'calculator' ? 'bg-blue-100 text-blue-600' : 'text-gray-600 hover:text-blue-600'}`}
                                        onClick={() => setCurrentView('calculator')}
                                    >
                                        ğŸ§® ë…¸í›„ìƒí™œë¹„ ê³„ì‚°ê¸°
                                    </button>
                                    <button 
                                        className={`px-4 py-2 rounded-lg font-semibold ${currentView === 'community' ? 'bg-blue-100 text-blue-600' : 'text-gray-600 hover:text-blue-600'}`}
                                        onClick={() => setCurrentView('community')}
                                    >
                                        ğŸ’¬ ì»¤ë®¤ë‹ˆí‹°
                                    </button>
                                    <button 
                                        className={`px-4 py-2 rounded-lg font-semibold ${currentView === 'services' ? 'bg-blue-100 text-blue-600' : 'text-gray-600 hover:text-blue-600'}`}
                                        onClick={() => setCurrentView('services')}
                                    >
                                        ğŸ›ï¸ ì‹œë‹ˆì–´ ë§ì¶¤ ì„œë¹„ìŠ¤
                                    </button>
                                    <button 
                                        className={`px-4 py-2 rounded-lg font-semibold ${communityTab === 'myprofile' ? 'bg-blue-100 text-blue-600' : 'text-gray-600 hover:text-blue-600'}`}
                                        onClick={() => {
                                            setCurrentView('community');
                                            setCommunityTab('myprofile');
                                        }}
                                    >
                                        ğŸ‘¤ ë‚´ í”„ë¡œí•„
                                    </button>
                                </div>
                            </div>
                        </div>
                    </nav>

                    {/* ë©”ì¸ ì½˜í…ì¸  */}
                    {currentView === 'calculator' && renderCalculator()}
                    {currentView === 'community' && renderCommunity()}
                    {currentView === 'services' && renderServices()}

                    {/* ì§€ì¶œ ë‚´ì—­ ì…ë ¥ ëª¨ë‹¬ */}
                    {showExpenseModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
                                <div className="p-6">
                                    <div className="flex justify-between items-center mb-4">
                                        <h2 className="text-2xl font-bold text-gray-800">ğŸ“Š ì›”ê°„ ì§€ì¶œë‚´ì—­</h2>
                                        <button
                                            onClick={closeExpenseModal}
                                            className="text-gray-500 hover:text-gray-700 text-2xl"
                                        >
                                            Ã—
                                        </button>
                                    </div>
                                    
                                    <p className="text-gray-600 mb-6">ì‹¤ì œ ì›”ê°„ ì§€ì¶œ ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (ë‹¨ìœ„: ë§Œì›)</p>
                                    
                                    <div className="space-y-4">
                                        <div>
                                            <label className="block text-lg font-semibold text-gray-700 mb-2">ğŸ½ï¸ ì‹ë¹„</label>
                                            <input
                                                type="number"
                                                className="w-full p-3 border-2 border-gray-200 rounded-lg text-lg [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
                                                value={expenseData.food}
                                                onChange={(e) => handleExpenseChange('food', e.target.value)}
                                            />
                                            <p className="text-sm text-green-600 mt-1">ì™¸ì‹ë¹„, ì‹ë£Œí’ˆë¹„ í¬í•¨</p>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-lg font-semibold text-gray-700 mb-2">ğŸ“± í†µì‹ ë¹„</label>
                                            <input
                                                type="number"
                                                className="w-full p-3 border-2 border-gray-200 rounded-lg text-lg [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
                                                value={expenseData.communication}
                                                onChange={(e) => handleExpenseChange('communication', e.target.value)}
                                            />
                                            <p className="text-sm text-green-600 mt-1">íœ´ëŒ€í°, ì¸í„°ë„·, TV ë“±</p>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-lg font-semibold text-gray-700 mb-2">ğŸ’° ê³µê³¼ê¸ˆ</label>
                                            <input
                                                type="number"
                                                className="w-full p-3 border-2 border-gray-200 rounded-lg text-lg [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
                                                value={expenseData.utilities}
                                                onChange={(e) => handleExpenseChange('utilities', e.target.value)}
                                            />
                                            <p className="text-sm text-green-600 mt-1">ì•„íŒŒíŠ¸ ê´€ë¦¬ë¹„, ì „ê¸°ê°€ìŠ¤ìˆ˜ë„ ë“±</p>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-lg font-semibold text-gray-700 mb-2">ğŸ  ìƒí™œë¹„</label>
                                            <input
                                                type="number"
                                                className="w-full p-3 border-2 border-gray-200 rounded-lg text-lg [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
                                                value={expenseData.living}
                                                onChange={(e) => handleExpenseChange('living', e.target.value)}
                                            />
                                            <p className="text-sm text-green-600 mt-1">êµí†µë¹„, ìƒí•„í’ˆ, ì˜ë¥˜ ë“±</p>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-lg font-semibold text-gray-700 mb-2">ğŸ¥ ì˜ë£Œë¹„</label>
                                            <input
                                                type="number"
                                                className="w-full p-3 border-2 border-gray-200 rounded-lg text-lg [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
                                                value={expenseData.medical}
                                                onChange={(e) => handleExpenseChange('medical', e.target.value)}
                                            />
                                            <p className="text-sm text-green-600 mt-1">ë³‘ì›ë¹„, ì•½ê°’, ê±´ê°•ë³´ì¡°ì‹í’ˆ ë“±</p>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-lg font-semibold text-gray-700 mb-2">ğŸ¨ ì·¨ë¯¸Â·ì—¬ê°€</label>
                                            <input
                                                type="number"
                                                className="w-full p-3 border-2 border-gray-200 rounded-lg text-lg [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
                                                value={expenseData.hobby}
                                                onChange={(e) => handleExpenseChange('hobby', e.target.value)}
                                            />
                                            <p className="text-sm text-green-600 mt-1">ì—¬í–‰, ì·¨ë¯¸í™œë™, ë¬¸í™”ìƒí™œ ë“±</p>
                                        </div>
                                    </div>
                                    
                                    <div className="bg-blue-50 p-4 rounded-lg mt-6">
                                        <p className="text-blue-800 font-semibold text-sm">
                                            ğŸ’¡ <strong>ì…ë ¥í•˜ì‹  ì •ë³´ëŠ” ìµëª…ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤</strong>
                                        </p>
                                        <p className="text-blue-700 text-sm mt-1">
                                            ë¹„ìŠ·í•œ ì—°ë ¹ëŒ€ì™€ ìì‚° ê·œëª¨ì˜ ì‚¬ëŒë“¤ê³¼ ë¹„êµ ë¶„ì„í•˜ì—¬ ì œê³µë©ë‹ˆë‹¤.
                                        </p>
                                        <p className="text-blue-700 text-sm mt-2">
                                            ğŸ”’ <strong>ê°œì¸ì •ë³´ ë³´í˜¸:</strong> ì„¸ê¸ˆì€ ì†Œë“ê³¼ ê´€ë ¨ë˜ëŠ” ë¯¼ê°ì •ë³´ì´ë¯€ë¡œ ìˆ˜ì§‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                                        </p>
                                    </div>
                                    
                                    <div className="flex gap-3 mt-6">
                                        <button
                                            onClick={closeExpenseModal}
                                            className="flex-1 py-3 bg-gray-300 text-gray-700 rounded-lg font-semibold"
                                        >
                                            ì·¨ì†Œ
                                        </button>
                                        <button
                                            onClick={submitExpenseData}
                                            className="flex-1 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg font-semibold"
                                        >
                                            ì €ì¥í•˜ê¸°
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* í•˜ë‹¨ ì¹´í”¼ë¼ì´íŠ¸ */}
                    <footer className="bg-gray-800 text-white py-8 text-center">
                        <p className="text-gray-400">
                            í–‰ë³µí•œ ë…¸í›„ìƒí™œì˜ ì‹œì‘, í”Œëœë¹„ | 
                            ê¸ˆìœµìƒí’ˆ íŒë§¤ ì—†ìŒ | ë¼ì´í”„ìŠ¤íƒ€ì¼ ì»¤ë®¤ë‹ˆí‹° ì¤‘ì‹¬ ì„œë¹„ìŠ¤
                        </p>
                        <p className="text-gray-500 text-sm mt-2">
                            ëª¨ë“  ì •ë³´ëŠ” ìµëª…ìœ¼ë¡œ ì²˜ë¦¬ë˜ë©° ê°œì¸ì •ë³´ëŠ” ë³´í˜¸ë©ë‹ˆë‹¤
                        </p>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<PlanBCommunityApp />, document.getElementById('root'));
    </script>
</body>
</html>